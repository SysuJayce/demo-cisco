<!DOCTYPE html>

<html lang="eng-US" xmlns:nitro="https://www.bunchball.com/nitro">

<head>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<title>  H1N1: Technical analysis reveals new capabilities</title>

	<meta property="og:image" content="https://alln-extcloud-storage.cisco.com/ciscoblogs/Unpack-460x230.png"/><meta property="og:description" content=""/><meta name="description" content=""/>	<meta property="og:site_name" content="blogs@Cisco - Cisco Blogs"/>

	<meta name="google-site-verification" content="9MlQU9MMQ1jHLMUkONKe6QzZ-ZIGRv0BCD1_rY1Zdmc" />

		<meta name="bitly-verification" content="25789e2a57d8"/>

	<meta name="accessLevel" content="GUEST, CUSTOMER, PARTNER"/>

	<meta name="language" content="en"/>

	<meta name="country" content="US"/>

	<meta name="contentType" content="ciscoBlogs"/>

			<meta name="docType" content="blogPost" />

		<link rel="stylesheet" href="https://blogs.cisco.com/wp-content/themes/cisco_responsive/style.css" type="text/css" media="screen" />

	<link rel="alternate" type="application/rss+xml" title="Cisco Blog RSS Feed" href="https://blogs.cisco.com/feed" />

	<link rel="shortcut icon" href="https://blogs.cisco.com/wp-content/themes/cisco_responsive/favicon.ico" />

	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">



	<link rel='dns-prefetch' href='//www.cisco.com' />
<link rel='dns-prefetch' href='//platform.twitter.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Cisco Blog &raquo; H1N1: Technical analysis reveals new capabilities Comments Feed" href="https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blogs.cisco.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='css-css'  href='https://blogs.cisco.com/wp-content/plugins/bunchball/bunchball.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='normalize-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/normalize.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='slidebarsstyle-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/slidebars.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='single-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/styles/single.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='codecolorer-css'  href='https://blogs.cisco.com/wp-content/plugins/codecolorer/codecolorer.css?ver=0.9.14' type='text/css' media='screen' />
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/jquery/jquery.js?ver=3.3.1'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.0.0'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/bunchball.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/jquery.cookie.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/jquery.slimscroll.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/moment.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/livestamp.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/modernizr.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/slidebars.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.lazyload.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/theme_script.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://www.cisco.com/assets/swa/j/blogs.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://www.cisco.com/c/dam/cdc/t/ctm.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.tools.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.tipTip.minified.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.sharrre.min.js?ver=4.9.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var single_script_vars = {"ajax_url":"https:\/\/blogs.cisco.com\/wp-admin\/admin-ajax.php","post_id":"203322"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/single.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=4.9.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.cisco.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.cisco.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Giving Back, Cisco Style, In Your Own Community' href='https://blogs.cisco.com/lifeatcisco/giving-back-cisco-style-in-your-own-community' />
<link rel='next' title='The Jetsons and the future of networking… Per new Cisco study, businesses demand more conveniences' href='https://blogs.cisco.com/sp/the-jetsons-and-the-future-of-networking-per-new-cisco-study-businesses-demand-more-conveniences' />

<link rel="canonical" href="https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities" />
<link rel='shortlink' href='https://blogs.cisco.com/?p=203322' />

<!-- START - Twitter Cards, G+, Facebook Tags 2.2.3.1 -->
 <!-- Facebook Open Graph -->
  <meta property="og:locale" content="en_US"/>
  <meta property="og:title" content="H1N1: Technical analysis reveals new capabilities"/>
  <meta property="og:url" content="https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2016-09-13T06:00:19+00:00"/>
  <meta property="article:modified_time" content="2017-05-30T13:00:24+00:00" />
  <meta property="og:updated_time" content="2017-05-30T13:00:24+00:00" />
  <meta property="article:section" content="Security"/>
  <meta property="article:publisher" content="https://www.facebook.com/Cisco"/>
 <!-- Google+ / Schema.org -->
 <!-- Twitter Cards -->
  <meta name="twitter:title" content="H1N1: Technical analysis reveals new capabilities"/>
  <meta name="twitter:url" content="https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities"/>
  <meta name="twitter:description" content="This blog is the first in a 3 part series that will provide an in-depth technical analysis on the H1N1 malware. I’ll be looking at how H1N1 has evolved, its obfuscation, analyzing its execution including new information stealing and user account control bypass capabilities, and finally exploring how"/>
  <meta name="twitter:image" content="https://alln-extcloud-storage.cisco.com/ciscoblogs/Unpack.png"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:site" content="@Cisco"/>
 <!-- SEO -->
 <!-- Misc. tags -->
 <!-- is_singular -->
<!-- END - Twitter Cards, G+, Facebook Tags 2.2.3.1 -->
	




</head>

<body>

	<div id = "rewards_fix"></div>

	<script src="//assets.bunchball.net/scripts/nitro/current/nitro.js" type="text/javascript"></script>	<script>
		var apiKey = "6912c6c82ccc4863a0311dc8b586b8fb";
		var userId = "anon";
		var time = "1521512448";
		var sig = "ba25c0b498a00a5f6bb5420c4f5c6f7c";
		var connectionParams={};
    		connectionParams.apiKey = apiKey ;
    		connectionParams.timeStamp = time;
    		connectionParams.signature = sig;
    		connectionParams.server =  "//CiscoSupportCommunities2.nitro.bunchball.net/nitro/json/";
    		connectionParams.userId = userId;
    	var nitro = new Nitro(connectionParams);
    	nitro.showPendingNotifications();
	</script> <header class = "sb-slide">
        <div id = "hero">
            <div class = "top_third">
                <div id="hamburger" class = "sb-open-left">
                    <i class="fa fa-bars"></i>
                </div>
            </div>
            <div class = "top_third">
                <div id = "cisco_logo">
                    <div class="dropdown">
                        <div class = "logo_hover"></div>
                        <div class="dropdown-content">
                            <ul>
                                <li><a href = "https://cisco.com">All of Cisco</a></li>
                                <li><a href = "https://blogs.cisco.com">Blogs Home</a></li>
                            </ul>
                         </div>
                    </div>
                </div>
            </div>
            <div class = "hero_header_text">Cisco Blogs</div>
                <div id = "mobile_search_top">
                    <i class="fa fa-search"></i>
                </div>

                <a class = "top_login" href = "https://socialrewards-prod.cloudapps.cisco.com/">Log In to Cisco.com</a>
                
                <div id = "normal_search">
                    <div id = "normal_search_box"><form method="get" id="searchform" action="https://blogs.cisco.com/">

	<input type="text" value=""

    	name="s" id="s">

    </input>

<input type="submit" value=" " class="searchSubmit"/>

</form>

</div>
                        <i class="fa fa-search"></i>
                    <div class = "clear"></div>
                </div>
            <div class = "clear"></div>
            <div id = "normal_menu">
                <nav>
  <a class = "hamburger_login" href = "https://blogs.cisco.com:9031/sp/startSSO.ping?PartnerIdpId=cloudsso.cisco.com">Log In to Cisco.com</a>      <ul>
                  <li><a href='https://blogs.cisco.com'><span>All Blogs</span></a></li>
                  <li><a href='#'><span>Technologies</span></a>
                  <ul>
            <div class = "bordertop"></div>
            <li><a href="https://blogs.cisco.com/analytics-automation">Analytics &amp; Automation</a></li>
            <li><a href="https://blogs.cisco.com/cloud">Cloud</a></li>
            <li><a href='https://blogs.cisco.com/collaboration'>Collaboration</a></li>
            <li><a href='https://blogs.cisco.com/datacenter'>Data Center</a></li>
            <li><a href='https://blogs.cisco.com/digital'>Digital Transformation</a></li>
            <li><a href='https://blogs.cisco.com/enterprise'>Enterprise Networks</a></li>
            <li><a href='https://blogs.cisco.com/innovation'>Innovation</a></li>
            <li><a href='https://blogs.cisco.com/wireless'>Mobility</a></li>
            <li><a href='https://blogs.cisco.com/security'>Security</a></li>
            <li class = "sub"><a href="https://blogs.cisco.com/talos" class="nav_menu" title="">Threat Research</a></li>
            <li><a href='https://blogs.cisco.com/smallbusiness'>Small Business</a></li>
            <li><a href='https://blogs.cisco.com/services'>Services</a></li>
            <li><a href='https://blogs.cisco.com/sp'>SP360:Service Provider</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Industries</span></a>
                      <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/education'>Education</a></li>
            <li><a href='https://blogs.cisco.com/energy'>Energy</a></li>
            <li><a href='https://blogs.cisco.com/financialservices'>Financial Services</a></li>
            <li><a href='https://blogs.cisco.com/government'>Government</a></li>
            <li><a href='https://blogs.cisco.com/healthcare'>Healthcare</a></li>
            <li><a href='https://blogs.cisco.com/manufacturing'>Manufacturing</a></li>
            <li><a href='https://blogs.cisco.com/retail'>Retail &amp; Hospitality</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Partners</span></a> 
          <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/partner'>Partner</a></li>
          </ul>
        </li>
        <li><a href='#'><span>For the Tech Expert</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/getyourbuildon'>Architects &amp; Distinguished Engineers</a></li>
            <li><a href='https://blogs.cisco.com/developer'>Developer</a></li>
            <li><a href='https://blogs.cisco.com/performance'>High Performance Computing</a></li>
            <li><a href='https://blogs.cisco.com/ciscoit'>Inside Cisco IT</a></li>
            <li><a href='https://blogs.cisco.com/cin'>TechWiseTV</a></li>
          </ul>
        </li>
         <li><a href='#'><span>Get to Know Cisco</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/csr'>Corporate Social Responsibility</a></li>
            <li><a href='https://blogs.cisco.com/cle'>Connected Life Exchange</a></li>
            <li><a href='https://blogs.cisco.com/customerstories'>Customer Stories</a></li>
            <li><a href='https://blogs.cisco.com/socialmedia'>Digital and Social Media</a></li>
            <li><a href='https://blogs.cisco.com/gov'>High Tech Policy</a></li>
            <li><a href='https://blogs.cisco.com/diversity'>Inclusion and Diversity</a></li>
            <li><a href='https://blogs.cisco.com/lifeatcisco'>Life at Cisco</a></li>
            <li><a href='https://blogs.cisco.com/perspectives'>Perspectives</a></li>
            <li><a href='https://blogs.cisco.com/news'>Executive Platform: News &amp; Insights</a></li>
          </ul>
        </li>
        <li class = "countries"><a href='#'><span>Countries and Regions</span></a>
          <ul>
            <div class = "col_1">
  <li><a href="https://apjc.thecisconetwork.com/">Asia Pacific</a>
  <li><a href="https://gblogs.cisco.com/at/">Austria</a>
  <li><span class = "sub_main">Belgium</span></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be">Dutch</a></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be-fr">French</a></li>
  <li><a href="https://gblogs.cisco.com/br/">Brazil</a>
  <li><span class = "sub_main">Canada</span></li>
    <li class = "sub"><a href="https://canadablog.cisco.com/">English</a></li>
    <li class = "sub"><a href="https://ciscocanadafr.wordpress.com/">French</a></li>

  </div>
    <div class = "col_2">
    <li><a href="https://gblogs.cisco.com/fin/">Finland</a>
    <li><a href="https://gblogs.cisco.com/fr/">France</a>

  <li><a href="https://gblogs.cisco.com/de">Germany</a></li>
  <li><a href="https://gblogs.cisco.com/gr/">Greece</a>
  <li><a href="https://gblogs.cisco.com/in">India</a></li>
  <li><a href="https://gblogs.cisco.com/it/">Italy</a></li>
  <li><a href="https://gblogs.cisco.com/jp/">Japan</a></li>
  <li><a href="https://ciscokrblog.com/">Korea</a></li>

  </div>
  <div class = "col_3">
  <li><span class = "sub_main">Latin America</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/la/">Latin America (Esp)</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/cansac/">Cansac</a></li>
  <li><a href="https://gblogs.cisco.com/nl/">Netherlands</a></li>
  <li><a href="https://gblogs.cisco.com/no">Norway</a></li>
  <li><a href="https://gblogs.cisco.com/pl">Poland</a></li>
  <li><a href="https://gblogs.cisco.com/pt">Portugal</a></li>
  <li><a href="https://gblogs.cisco.com/ro">Romania</a></li>
  </div>

  <div class = "col_4">
  <li><a href="https://gblogs.cisco.com/ru">Russia</a></li>
  <li><a href="https://gblogs.cisco.com/es">Spain</a></li>
  <li><span class = "sub_main">Switzerland</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-tech/">English</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-fr/">French</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-de/">German</a></li>
  <li><a href="https://gblogs.cisco.com/tr/">Turkey</a></li>
  <li><a href="https://gblogs.cisco.com/uki/">UK &amp; Ireland</a></li>
</div>
<div class = "clear"></div>
</ul>
</li>
      </ul>
</nav>
            </div>
            <div id = "mobile_search">
                <div id = "mobile_search_box">
                    <form method="get" id="searchform" action="https://blogs.cisco.com/">

	<input type="text" value=""

    	name="s" id="s">

    </input>

<input type="submit" value=" " class="searchSubmit"/>

</form>

                </div>
        </div>
        </div>  
    </header>
     
        
  <div id="share_bar1">

    <span class = "share_title">Share</span>
    <div class="twitter sharrre">
      <div class = "box">
        <div class = "count twitcount"></div>
        <a class = "twitclick" href="https://twitter.com/intent/tweet?url=http://bit.ly/2ctl1Rp&text=H1N1: Technical analysis reveals new capabilities&via=ciscosecurity" data-config-metrics-group='social_shares' data-config-metrics-title='twitter_shares' data-config-metrics-item='twitter_share'>tweet</a>
      </div>
    </div>

    <div class="facebook sharrre">
      <div class = "box">
        <div class = "count fbcount"></div>
        <a class = "fbclick share" href = "http://www.facebook.com/sharer/sharer.php?u=https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities&title=H1N1: Technical analysis reveals new capabilities" data-config-metrics-group='social_shares' data-config-metrics-title='facebook_shares' data-config-metrics-item='facebook_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>


    <div class="linkedin sharrre">
      <div class = "box">
        <div class = "count licount"></div>
        <a class = "liclick share" href = "https://www.linkedin.com/cws/share?url=https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='linkedin_shares' data-config-metrics-item='linkedin_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>


      </div>
    </div>

    <div class="googleplus sharrre">
      <div class = "box">
        <div class = "count gpcount"></div>
        <a class = "gpclick share" href="https://plus.google.com/share?url=https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='google_shares' data-config-metrics-item='google_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>
        <div class = "share_mail"><a class="email emclick" href="mailto:?subject=Cisco Blog: H1N1: Technical analysis reveals new capabilities&body=I saw this post on Cisco Security blog and thought you might like to read it.%0A%0AH1N1: Technical analysis reveals new capabilities%0A%0Ahttps://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities%0A%0A****Disclaimer****%0A%0ACisco is not responsible for the content of this email, and its contents do not necessarily reflect Cisco’s views or opinions. Cisco has not verified the email address or name of the sender." data-config-metrics-group='social_shares' data-config-metrics-title='email_shares' data-config-metrics-item='email_share'></a></div>
    <div class = "clear"></div>
  </div>
  <div id="sb-site">
<div id = "main_content">

	<div id = "blog_content">
	<div id = "main_left">

		<article id = "article_post">
			<p class = "breadcrumb">
			<a href=' https://blogs.cisco.com'>Cisco Blog</a> > <a href=' https://blogs.cisco.com/category/security/'>Security</a></p>
					<div id = "post_image"><img src = "https://alln-extcloud-storage.cisco.com/ciscoblogs/Unpack-460x230.png">  					</div>
  					<div id = "post_info">
  						<span class = "post_category">
  							Security  						</span>
						<h1 id="post-203322" class="kindle_title title">H1N1: Technical analysis reveals new capabilities</h1>
						<div class="author_image"><img class = "img-circle" src = "https://alln-extcloud-storage.cisco.com/ciscoblogs/userphoto/1470941003-bpthumb.jpg"></div><div class="author_rewards_box">			<ul class = "nitro_author203322 bunchballAwards">
		<li>
			<div class = "nitro_badge badgenitro_author203322">
			</div>
			<div class = "nitro_points pointsnitro_author203322">
			</div>
		</li>
		<script>
var nitroName = 'joshreyn';
var sessionKey = '';


nitro.callAPI("method=batch.run&methodFeed=%5B%27method%3Duser.getChallengeProgress%26userId%3D" + nitroName + "%26sessionKey%3D" + sessionKey + "%27%2C%27method%3Duser.getLevel%26userIds%3D" + nitroName + "%26sessionKey%3D" + sessionKey + "%27%2C%27method%3Duser.getPointsBalance%26userId%3D" + nitroName + "%26sessionKey%3D" + sessionKey + "%27%5D",  "postBadges", "nitro_author203322");</script>

		</ul>
		</ul>
	<div class = "clear"></div>
</div><div class = "clear"></div><span class = "list_author"><a href="https://blogs.cisco.com/author/joshreynolds" title="Posts by Josh Reynolds" rel="author">Josh Reynolds</a> - September 13, 2016 - 2 Comments      					</span>
      					<br />
      					<br />
      										</div>
					<div class ="clear"></div>
					<div id ="content">
					<p>This blog is the first in a <a href="http://blogs.cisco.com/tag/h1n1-malware">3 <font color="red">part series</font></a> that will provide an in-depth technical analysis on the <font color="red">H1N1</font> <font color="red">malware</font>. I’ll be looking at how <font color="red">H1N1</font> has evolved, its <font color="red">obfuscation</font>, analyzing its <font color="red">execution</font> including new information stealing and user account control bypass <font color="red">capabilities</font>, and finally exploring how we are both using and influencing security tools with this research.</p>
<h1>Overview</h1>
<p>Through the use of general characteristics exhibited by <font color="red">malware</font> authors we are able to broadly categorize and positively identify malicious samples. These characteristics, discussed in <a href="https://blogs.cisco.com/security/the-general-behavior-of-ransomware"><em>The General Behavior of </em><font color="red">Ransomware</font></a> are indexed in a database, which allows us to identify patterns, outliers and obtain greater visibility and insight into various <font color="red">threats</font>.</p>
<h1><font color="red">H1N1</font>’s evolution: past and present</h1>
<p>These <font color="red">data</font> sets provide insight into the ever-growing attack vectors that affect our customers, which include <font color="red">malware</font> delivery mechanisms. In this <font color="red">blog series</font> we highlight newly added functionality to a <font color="blue">malware variant</font> that started out as being a ‘loader’ (strictly provides <font color="red">capabilities</font> of loading other more complex <font color="red">malware variants</font>) known as <font color="red">H1N1</font>, and has now evolved into an information stealing variant.</p>
<p>Throughout the <font color="red">data</font> mining exercises conducted by my colleagues and I on the <a href="http://www.cisco.com/web/go/amptg"><font color="red">AMP</font> <font color="red">Threat</font> <font color="red">Grid</font></a> Research &amp; Efficacy Team (RET) we have observed a widely distributed campaign using VBA <font color="red">macros</font> to infect machines with a variant of information-stealing <font color="red">malware</font>. Based on the initial characteristics observed by <font color="red">AMP</font> <font color="red">Threat</font> <font color="red">Grid</font> we believed these malicious <font color="red">documents</font> were distributing a <font color="red">Ransomware</font> variant; however, we later found the dropped <font color="red">executables</font> to be a variant of the <font color="red">H1N1</font> loader. <font color="red">H1N1</font> is a loader <font color="blue">malware variant</font> that has been known to deliver Pony DLLs and Vawtrak <font color="red">executables</font> to infected machines. Upon infection, <font color="red">H1N1</font> previously only provided loading and system information reporting <font color="red">capabilities</font>.<sup>1,2</sup></p>
<h1>Key findings from our analysis include:</h1>
<ul>
<li>Unique <font color="red">obfuscation</font> techniques</li>
<li>A novel DLL hijacking <font color="red">vulnerability</font> resulting in a User Account Control bypass</li>
<li>Added information stealing <font color="red">capabilities</font></li>
<li>Self-propagation/lateral movement <font color="red">capabilities</font></li>
</ul>
<h1>Background</h1>
<p><font color="red">H1N1</font> has added a plethora of <font color="red">new functionality</font> in comparison to earlier reports. Throughout this <font color="red">blog series</font> we will be analyzing the <font color="red">capabilities</font> of <font color="red">H1N1</font> including: <font color="red">obfuscation</font>, a User Account Control (UAC) bypass, information stealing, <font color="red">data exfiltration</font>, loader/dropper, and self-propagation/lateral movement techniques used by this variant.<sup>1,2</sup></p>
<h1>Infection Vector</h1>
<p>The use of Visual Basic <font color="red">macros</font> is nothing new, however, in recent months they have become one of the most popular infection vectors for all <font color="red">malware</font> types, especially for <font color="red">Ransomware</font> campaigns. These <font color="red">macros</font> vary in sophistication from performing the download and <font color="red">execution</font> of hosted binaries, to dropping the binaries themselves. In this campaign we see the latter where the <font color="red">document</font> ships an entire encoded binary within the text box of a VBA <font color="red">macro</font> form. All <font color="red">documents</font> throughout this campaign have used a common naming convention in the following formats:</p>
<ul>
<li><em>[domain]_card_screenshot.doc</em></li>
<li><em>confirmation_[random <font color="red">integers</font>].doc</em></li>
<li><em>bank_confirmation_[random <font color="red">integers</font>].doc</em></li>
<li><em>debit_request_[random <font color="red">integers</font>].doc</em></li>
<li><em>creditcard_statement_[random <font color="red">integers</font>].doc</em></li>
<li><em>insurance_[random <font color="red">integers</font>].doc</em></li>
<li><em>inventory_list_[random <font color="red">integers</font>].doc</em></li>
<li><em>debt_[random <font color="red">integers</font>].doc</em></li>
</ul>
<p>The domains for the first format observed include the financial, energy, communications, military and government sectors. Unsurprisingly, these <font color="red">documents</font> are delivered through spear-phishing e-mail campaigns. A number of subject headings can be observed in VirusTotal:</p>
<div id="attachment_203323" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig1.png"><img class="size-large wp-image-203323" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig1-550x267.png" alt="Figure 1.0: Attached e-mail subject headings in VirusTotal for identified <font color="red">documents</font>" width="550" height="267" /></a><p class="wp-caption-text">Figure 1.0: Attached e-mail subject headings in VirusTotal for identified documents</p></div>
<p>Although the specified domain in the filename differentiates between targets, the lure message within the <font color="red">phishing</font> e-mail does not vary drastically, for example:</p>
<div id="attachment_203325" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig2.png"><img class="size-large wp-image-203325" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig2-550x285.png" alt="Figure 2.0: Example <font color="red">phishing</font> message within attached e-mail" width="550" height="285" /></a><p class="wp-caption-text">Figure 2.0: Example phishing message within attached e-mail</p></div>
<p>The remaining formats appear to simply seem enticing enough to open being related finance, corporate or personal information.</p>
<p>Upon opening the <font color="red">document</font>, the <font color="red">attacker</font> attempts to social engineer the user into executing the malicious <font color="red">macro</font> content by stating it will adjust to their version of Microsoft Word:</p>
<div id="attachment_223518" style="max-width: 855px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/H1N1-fig-3.png"><img class="size-full wp-image-223518" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/H1N1-fig-3.png" alt="" width="845" height="705" /></a><p class="wp-caption-text">Figure 3.0: <font color="red">Social engineering</font> content of <font color="red">document</font> to open <font color="red">macros</font></p></div>
<h1>Dropper <font color="red">Obfuscation</font></h1>
<p>The VBA <font color="red">macro</font> is highly obfuscated, making use of many VBA tricks to hide its true intent. These include the use of string <font color="red">functions</font>: StrReverse, Ucase, Lcase, Right, Mid, and Left. For example, the following gets the %temp% path:</p>
<div id="attachment_203327" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig4.png"><img class="wp-image-203327 size-large" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig4-550x291.png" alt="fig4" width="550" height="291" /></a><p class="wp-caption-text">Figure 4.0: String <font color="red">obfuscation</font> mechanisms to get %temp%</p></div>
<p>Mid is used here to produce “<em>.<font color="red">Scripting</font></em>”, Ucase and StrReverse are used to produce “FIleSystemObject”, which is used to create a VBA FileSystemObject, that is then used with GetSpecialFolder, and some basic arithmetic resulting in “2” to get %temp%.As mentioned, the binary to be executed is extracted from a VBA form text box:</p>
<div id="attachment_203331" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig5.png"><img class="size-large wp-image-203331" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig5-550x247.png" alt="Figure 5.0: VBA form containing obfuscated PE within text box" width="550" height="247" /></a><p class="wp-caption-text">Figure 5.0: VBA form containing obfuscated PE within text box</p></div>
<p>The text box content is set into a variable, which is then passed off to a de-obfuscation <font color="red">function</font>. The core de-obfuscation functionality is a two steps process. The first is an <font color="red">XOR</font> loop with a fixed <font color="red">byte</font> key of 0xE, which produces a <font color="red">base64</font> encoded portable <font color="red">executable</font> (PE):</p>
<div id="attachment_203332" style="max-width: 310px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig6.png"><img class="wp-image-203332 size-medium" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig6-300x44.png" alt="Figure 6.0: <font color="red">XOR</font> decoding/de-obfuscation loop" width="300" height="44" /></a><p class="wp-caption-text">Figure 6.0: XOR decoding/de-obfuscation loop</p></div>
<p>The second is a VBA implementation of <font color="red">base64</font> that decodes it to produce a final Portable <font color="red">Executable</font> (PE):</p>
<div id="attachment_203344" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig7.png"><img class="size-large wp-image-203344" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig7-550x389.png" alt="Figure 7.0: VBA <font color="red">Base64</font> implementation" width="550" height="389" /></a><p class="wp-caption-text">Figure 7.0: VBA Base64 implementation</p></div>
<p>The de-obfuscated <font color="red">executable</font> is then written to %temp% and executed. We can follow the <font color="red">execution</font> flow through the use of process visualization in <font color="red">AMP</font> <font color="red">Threat</font> <font color="red">Grid</font>. What this provides is graphed process interactions (child-parent relationships) for the entirety of the run. In the case of the <font color="red">H1N1</font> malicious <font color="red">document</font>, it is very apparent that WINWORD.EXE is executing a separate binary:</p>
<div id="attachment_203345" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig8.png"><img class="size-large wp-image-203345" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig8-550x459.png" alt="Figure 8.0: Process graph showing <font color="red">execution</font> of dropped <font color="red">executable</font> from Microsoft Word" width="550" height="459" /></a><p class="wp-caption-text">Figure 8.0: Process graph showing execution of dropped <font color="red">executable</font> from Microsoft Word</p></div>
<h1>Unpacking</h1>
<p><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/Unpack.png"><img class="aligncenter size-large wp-image-203401" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/Unpack-550x176.png" alt="Unpack" width="550" height="176" /></a></p>
<p>The binary has a total of three routines responsible for unpacking and injection. The first routine injects via the following steps:</p>
<ul>
<li>Unpacking algorithm unpacks code to be written</li>
</ul>
<ul>
<li>Creates a suspended process of the executable written to %temp% from the <font color="red">document</font> with CreateProcessA</li>
</ul>
<ul>
<li>Writes to that image with WriteProcessMemory</li>
</ul>
<ul>
<li>Uses GetThreatContext, SetThreadContext and ResumeThread to execute at the EP of the unpacked <font color="red">executable</font>. On the call to WriteProcessMemory we see the lpBuffer address points to a complete PE, as is indicated by the MZ header:</li>
</ul>
<div id="attachment_203346" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig9.png"><img class="size-large wp-image-203346" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig9-550x213.png" alt="9.0: First MZ from WriteProcessMemory lpBuffer argument" width="550" height="213" /></a><p class="wp-caption-text">9.0: First MZ from WriteProcessMemory lpBuffer argument</p></div>
<p>We can then dump this to disk for analysis of the next unpacking stage. The next routine makes use of the injection method used by Duqu to write its unpacked image<sup>3</sup>:</p>
<p><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/CreateProcessW.png"><img class="aligncenter size-large wp-image-203403" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/CreateProcessW-550x278.png" alt="CreateProcessW" width="550" height="278" /></a></p>
<ul>
<li>CreateProcessW is called to create a suspended ‘Explorer.exe’ process</li>
<li>Use the handle from PROCESS_INFORMATION produced by CreateProcessW with ZwQueryInformationProcess to get Explorer.exe PEB and ImageBaseAddress</li>
<li>Allocate and write up to 500 <font color="red">bytes</font> of of the Explorer.exe process using ReadProcessMemory</li>
<li>Get actual image size from PE header, allocated this size, and write entire Explorer.exe image into memory</li>
<li>Use UnMapViewOfSection with ImageBaseAddress and process handle of Explorer.exe from step 2 to un-map the current section in order to avoid STATUS_CONFLICTING_ADDRESSES upon mapping of the new section</li>
<li>Overwrite image sections of Explorer.exe with unpacked (of the current step) <font color="red">executable</font> code</li>
<li>Use MapViewOfSection to map the manipulated Explorer.exe using the process handle from step 2</li>
<li>Call ResumeThread to start <font color="red">execution</font> of unpacked code (of the current step)</li>
</ul>
<p>In order to continue to trace the <font color="red">execution</font> of this code (to what we discovered was more unpacking code) we wrote 0xEBFE (relative JMP to offset 0) to the entry point of the newly written Explorer.exe. This causes Explorer.exe to spin until we can attach to this process with a debugger.</p>
<p>Breaking on the first VirtualAlloc performed by the injected process enabled us to see a large allocation occur, and setting a breakpoint on writing to this memory location makes it apparent that an entire DLL is written to this memory location by the (current) unpacking code:</p>
<div id="attachment_203347" style="max-width: 379px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig10.png"><img class="size-full wp-image-203347" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig10.png" alt="Figure 10.0: Upack MZ to be injected" width="369" height="460" /></a><p class="wp-caption-text">Figure 10.0: Upack MZ to be injected</p></div>
<p>Looking at the PE header the string “UpackByDwing” is apparent which indicates that this packer is being used on the final binary. Opening up this code with a disassembler (in this case IDA Pro) showed the following jump that could not be followed when the <font color="red">functions</font> were graphed:</p>
<div id="attachment_203348" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig11.png"><img class="size-large wp-image-203348" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig11-550x186.png" alt="Figure 11.0: <font color="red">Function</font> graph for final Upack unpacking stage" width="550" height="186" /></a><p class="wp-caption-text">Figure 11.0: Function graph for final Upack unpacking stage</p></div>
<p>There is an infamous POPAD prior to this jump, which for those seasoned unpackers, is indicative of leading to the OEP of an unpacked binary due to restoring of the register state prior to the unpacked code being called. If a breakpoint is set on the OEP identified and we continue to trace through the injected code within Explorer.exe, it becomes clear that this address is eventually called from the unpacking code. At this point, once the breakpoint is hit, we can dump the unpacked binary to disk.</p>
<p>One final hurdle is required in order to get an independent <font color="red">executable</font> that can be debugged. When the binary is written and jumped to, a pointer argument is passed on the stack that is later dereferenced within the binary. This is provided when the binary is unpacked from the injected Explorer.exe, however a null pointer is passed when the binary is executed independently. This argument points to a size value of 0x31DB used for a call to VirtualAlloc. We can edit the unpacked code in-line to point to a known address with this value:</p>
<div id="attachment_203349" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig12.png"><img class="size-large wp-image-203349" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig12-550x146.png" alt="Figure 12.0: In-line edits to allow independent binary <font color="red">execution</font>" width="550" height="146" /></a><p class="wp-caption-text">Figure 12.0: In-line edits to allow independent binary execution</p></div>
<h1>Analysis</h1>
<p>I’m only going to cover the <font color="red">obfuscation</font> techniques used by <font color="red">H1N1</font> in this blog. The remaining analysis of <font color="red">H1N1</font> will be posted in my <font color="red">next blog</font>.</p>
<h2><font color="red">Obfuscation</font></h2>
<p>Upon opening the binary in a disassembler (in this case IDA Pro) we see that imports are resolved dynamically using hashing of DLLs and exports, and a string <font color="red">obfuscation</font> technique used throughout the binary.</p>
<h2>String <font color="red">Obfuscation</font></h2>
<p>The string <font color="red">obfuscation</font> technique makes use of SUB, <font color="red">XOR</font>, and ADD with fixed DWORD values, and the result of each step using is stored using STOSD. The result of each operation is then used as the input (within EAX) for each subsequent step. For example:</p>
<div id="attachment_203350" style="max-width: 560px" class="wp-caption aligncenter"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig13.png"><img class="size-large wp-image-203350" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/fig13-550x264.png" alt="Figure 13.0: String <font color="red">obfuscation</font> technique example" width="550" height="264" /></a><p class="wp-caption-text">Figure 13.0: String obfuscation technique example</p></div>
<p>The result of these operations produces the path to the WOW64 version of svchost.exe. We’ve written an IDAPython <font color="red">script</font> to automatically decode these strings from a provided address starting with the XORing of EAX, performing operations on the DWORDs involved up to a certain “depth” (as strings vary in length), and adding the resulting string as a comment next to the next instruction head.<sup>4</sup></p>
<h2>Import <font color="red">Obfuscation</font> (via Import Hashing)</h2>
<p>Hashed imports can be resolved by hashing the library export names ourselves. Import name strings are obfuscated using the technique mentioned above, and export names from each library are hashed by walking the export table and performing a simple <font color="red">XOR</font> and ROL loop over each name:</p>
<p style="padding-left: 30px;">for(i = 0; i &lt; strlen(export_name); i++) {</p>
<p style="padding-left: 30px;">r = rol32(r, 7);</p>
<p style="padding-left: 30px;">r ^= export_name[i];</p>
<p style="padding-left: 30px;">}</p>
<p>We’ve replicated the hashing algorithm and all exports can be hashed from a given DLL. These hash values can be mapped within IDA using a C header file generated by our <font color="red">python script</font>.<sup>5</sup></p>
<h2>To be continued…</h2>
<p>In the <font color="red">next blog</font> I’ll provide the analysis of <font color="red">H1N1</font>&#8217;s <font color="red">execution</font>. Stay tuned!</p>
<hr />
<p>[1] <a href="https://www.proofpoint.com/tw/threat-insight/post/hancitor-ruckguv-reappear">https://www.proofpoint.com/tw/threat-insight/post/hancitor-ruckguv-reappear</a></p>
<p>[2] <a href="https://www.arbornetworks.com/blog/asert/wp-content/uploads/2015/06/blog_h1n1.pdf">https://www.arbornetworks.com/blog/asert/wp-content/uploads/2015/06/blog_h1n1.pdf</a></p>
<p>[3] <a href="http://blog.w4kfu.com/tag/duqu">http://blog.w4kfu.com/tag/duqu</a></p>
<p>[4] <a href="https://communities.cisco.com/docs/DOC-69444">https://communities.cisco.com/docs/DOC-69444</a></p>
<p>[5] <a href="https://communities.cisco.com/docs/DOC-69443">https://communities.cisco.com/docs/DOC-69443</a></p>
Tags:<br /><ul class = "tagged"><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=amp-threat-grid">AMP Threat Grid</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=h1n1-malware">H1N1 malware</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=malware-analysis">Malware Analysis</a></li></ul>		</div>
			<div id = "comments">
				<div id = "respond">
				<p class = "cisco_respond">In an effort to keep conversations fresh, Cisco Blogs closes comments after 60 days. Please visit the <a href ="https://blogs.cisco.com">Cisco Blogs hub page</a> for the latest content.</p>
			<p><span class = "comment_heading">2 Comments</span></p>
		<ol class="commentlist" id="thecomments">
				
<li>
			<div id="comment-2415513">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg' width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
							<a href = "https://blogs.cisco.com/rewards-profile/8155">Dr. Jose A. Wong - Perez</a>
						</span>
						<br />
						<span class="comment-meta commentmetadata">September 15, 2016 at 4:00 pm</span>

					</div>
				<div class="comment_text">
					<ul class = "comment_id2415513 bunchballAwards" style="margin-top: 5px; margin-right: -20px; margin-left: 0px; height: 55px;">
								<script>
									var nitroName = 'Spoulakk4';
									var sessionKey = '';


									nitro.callAPI("method=batch.run&methodFeed=%5B%27method%3Duser.getChallengeProgress%26userId%3D" + nitroName + "%26sessionKey%3D" + sessionKey + "%27%2C%27method%3Duser.getLevel%26userIds%3D" + nitroName + "%26sessionKey%3D" + sessionKey + "%27%2C%27method%3Duser.getPointsBalance%26userId%3D" + nitroName + "%26sessionKey%3D" + sessionKey + "%27%5D",  "commentBadges", "comment_id2415513");</script>

							<li>
								<div class = "nitro_badge badgecomment_id2415513">
								</div>
								<div class = "nitro_points pointscomment_id2415513">
								</div>
							</li>
							</ul>
					<div class = "clear"></div> <p>I can definitely say that in this post are the "tools of the trade ", the insides to begin the journey to gain a good understanding of "H1N1", its a real jewel.</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike2415513" class = "commentLikeButton commentlike" data-nitro =Spoulakk4 >0 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-2415466">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						Mike						</span>
						<br />
						<span class="comment-meta commentmetadata">September 15, 2016 at 6:48 am</span>

					</div>
				<div class="comment_text">
				<p>Great article! Most analysis that is written tends to be very high-level and not really get into the proverbial "nuts &amp; bolts" the malware techniques. I much prefer this sort of deep dive style with the greater detail on how the code works, what it does, and how it does it.



Well done, and an excellent read.</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike2415466" class = "commentLikeButton commentlike" data-nitro = >2 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->
			</ol>
	</div>

			</div>
		</article>

	</div>
	<div id = "main_right">
		<ul id = "sidebar">

  <li id="subscribe" class="widget">
    <h3>Subscribe to Security:</h3>
    <div id="subscribe_box">
      <form id ="subscribe_form" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=CiscoBlogSecurity', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
        <input type="text" class="subscribe" name="email" value="Enter email address" onFocus="if(this.value == 'Enter email address') {this.value = '';}" onBlur="if (this.value == '') {this.value = 'Enter email address';}"></input>
        <input type="hidden" value="CiscoBlogSecurity" name="uri" ></input>
        <input type="hidden" name="loc" value="en_US"></input>
        <input type="submit" class="subscribe_button" value="Subscribe" ></input>
        <div class="clear"></div>
      </form>
    </div>
    <div class="clear"></div>

</li>

<li id="social_widget" class="widget">
  <h3>Connect with Security</h3>
  <ul>
        <li><a target='_blank' href="https://www.facebook.com/ciscosecurity?ref=nf"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_fb.png" alt="Facebook"></a></li>
    <li><a target='_blank' href="https://twitter.com/ciscosecurity"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_tw.png" alt="Twitter"></a></li>
    <li><a target='_blank' href="http://www.linkedin.com/company/cisco"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_li.png" alt="Linkedin"></a></li>
    <li><a target='_blank' href="https://plus.google.com/106092229730683979920"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_gp.png" alt="Google+"></a></li>
    <li><a target='_blank' href="https://www.slideshare.net/ciscosystems"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_ss.png" alt="Slideshare"></a></li>
    <li><a target='_blank' href="http://youtubecisco.com/security"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_yt.png" alt="YouTube"></a></li>
    <li><a target='_blank' href="https://www.instagram.com/cisco/?hl=en"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_ig.png" alt="Instagram"></a></li>
    <li><a href="https://feeds.feedburner.com/CiscoBlogSecurity"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/rss.png" width = "24" height = "24" alt = "Rss"></a></li>
      </ul>
</li>
	<li>
		<div id = "nitroLoggedOut" class="widget">
			<div class = "consoleTitle">
				Cisco Social Rewards
			</div>
			<div class = "consoleTextNoLog">
				Get credit for all your Cisco site participation with Social Rewards. <a href = "https://blogs.cisco.com/rewards-about">Learn More</a>			</div>
						<a href = "https://socialrewards-prod.cloudapps.cisco.com/" class = "joinNow">Join Today</a>
			<div class = "consoleTextNoLog">
				Already a member?  <a href = "https://socialrewards-prod.cloudapps.cisco.com/" class = "already">Log In</a>
			</div>
			</div>
</li> 	<script>


	nitro.callAPI("method=site.getActionFeed&apiKey=6912c6c82ccc4863a0311dc8b586b8fb&showLevelChanges=true&preferences=userFullName|profileUrl|userPhotoUrl", "newsfeed");
	</script>
	<li>
		 <div id ="newsfeedWidget">
			<div class = "newsfeed_header">
				Latest Rewards
				<a href = "https://blogs.cisco.com/rewards-about" class = "newsIcon"><img src = "/wp-content/plugins/bunchball/images/infoIcon.png"></a>
			</div>
			<div id = "newsInnerContent">
				<ul id = "newsfeed">
				</ul>
			</div>
		</div>
	</li>
    <li id="blogroll">
            <ul id="blogroll_links">
          <li class="roll_heading">What We're Reading</li>

            <li><a href="http://www.cert.org/blogs/vuls/" target="_blank">CERT Vulnerability Analysis</a></li>
                      <li><a href="http://blogs.technet.com/b/srd/" target="_blank">Microsoft Security Research & Defense</a></li>
                      <li><a href="http://isc.sans.edu/index.html" target="_blank">SANS Internet Storm Center</a></li>
                      <li><a href="http://www.schneier.com/" target="_blank">Schneier on Security</a></li>
                  </ul>
              <ul id="related_links">
          <li class="roll_heading">Related Links</li>
                    <li><a href="http://www.cisco.com/en/US/products/products_security_advisories_listing.html" target="_blank">Advisories and Responses</a></li>
                        <li><a href="http://tools.cisco.com/security/center/cyberRiskReport.x" target="_blank">Cyber Risk Reports</a></li>
                        <li><a href="http://tools.cisco.com/security/center/intelliPapers.x?i=55" target="_blank">Security Best Practices</a></li>
                        <li><a href="http://tools.cisco.com/security/center/home.x" target="_blank">Security Intelligence Operations</a></li>
                        <li><a href="http://www.cisco.com/en/US/products/hw/vpndevc/index.html" target="_blank">Security Products</a></li>
                  </ul>
          </li>
  </ul>	</div>
	<div class = "clear"></div>
</div>
</div>
</div>
   

<div class="sb-slidebar sb-left sb-width-custom sb-momentum-scrolling " data-sb-width="50%">
    <nav>
  <a class = "hamburger_login" href = "https://blogs.cisco.com:9031/sp/startSSO.ping?PartnerIdpId=cloudsso.cisco.com">Log In to Cisco.com</a>      <ul>
                  <li><a href='https://blogs.cisco.com'><span>All Blogs</span></a></li>
                  <li><a href='#'><span>Technologies</span></a>
                  <ul>
            <div class = "bordertop"></div>
            <li><a href="https://blogs.cisco.com/analytics-automation">Analytics &amp; Automation</a></li>
            <li><a href="https://blogs.cisco.com/cloud">Cloud</a></li>
            <li><a href='https://blogs.cisco.com/collaboration'>Collaboration</a></li>
            <li><a href='https://blogs.cisco.com/datacenter'>Data Center</a></li>
            <li><a href='https://blogs.cisco.com/digital'>Digital Transformation</a></li>
            <li><a href='https://blogs.cisco.com/enterprise'>Enterprise Networks</a></li>
            <li><a href='https://blogs.cisco.com/innovation'>Innovation</a></li>
            <li><a href='https://blogs.cisco.com/wireless'>Mobility</a></li>
            <li><a href='https://blogs.cisco.com/security'>Security</a></li>
            <li class = "sub"><a href="https://blogs.cisco.com/talos" class="nav_menu" title="">Threat Research</a></li>
            <li><a href='https://blogs.cisco.com/smallbusiness'>Small Business</a></li>
            <li><a href='https://blogs.cisco.com/services'>Services</a></li>
            <li><a href='https://blogs.cisco.com/sp'>SP360:Service Provider</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Industries</span></a>
                      <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/education'>Education</a></li>
            <li><a href='https://blogs.cisco.com/energy'>Energy</a></li>
            <li><a href='https://blogs.cisco.com/financialservices'>Financial Services</a></li>
            <li><a href='https://blogs.cisco.com/government'>Government</a></li>
            <li><a href='https://blogs.cisco.com/healthcare'>Healthcare</a></li>
            <li><a href='https://blogs.cisco.com/manufacturing'>Manufacturing</a></li>
            <li><a href='https://blogs.cisco.com/retail'>Retail &amp; Hospitality</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Partners</span></a> 
          <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/partner'>Partner</a></li>
          </ul>
        </li>
        <li><a href='#'><span>For the Tech Expert</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/getyourbuildon'>Architects &amp; Distinguished Engineers</a></li>
            <li><a href='https://blogs.cisco.com/developer'>Developer</a></li>
            <li><a href='https://blogs.cisco.com/performance'>High Performance Computing</a></li>
            <li><a href='https://blogs.cisco.com/ciscoit'>Inside Cisco IT</a></li>
            <li><a href='https://blogs.cisco.com/cin'>TechWiseTV</a></li>
          </ul>
        </li>
         <li><a href='#'><span>Get to Know Cisco</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/csr'>Corporate Social Responsibility</a></li>
            <li><a href='https://blogs.cisco.com/cle'>Connected Life Exchange</a></li>
            <li><a href='https://blogs.cisco.com/customerstories'>Customer Stories</a></li>
            <li><a href='https://blogs.cisco.com/socialmedia'>Digital and Social Media</a></li>
            <li><a href='https://blogs.cisco.com/gov'>High Tech Policy</a></li>
            <li><a href='https://blogs.cisco.com/diversity'>Inclusion and Diversity</a></li>
            <li><a href='https://blogs.cisco.com/lifeatcisco'>Life at Cisco</a></li>
            <li><a href='https://blogs.cisco.com/perspectives'>Perspectives</a></li>
            <li><a href='https://blogs.cisco.com/news'>Executive Platform: News &amp; Insights</a></li>
          </ul>
        </li>
        <li class = "countries"><a href='#'><span>Countries and Regions</span></a>
          <ul>
            <div class = "col_1">
  <li><a href="https://apjc.thecisconetwork.com/">Asia Pacific</a>
  <li><a href="https://gblogs.cisco.com/at/">Austria</a>
  <li><span class = "sub_main">Belgium</span></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be">Dutch</a></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be-fr">French</a></li>
  <li><a href="https://gblogs.cisco.com/br/">Brazil</a>
  <li><span class = "sub_main">Canada</span></li>
    <li class = "sub"><a href="https://canadablog.cisco.com/">English</a></li>
    <li class = "sub"><a href="https://ciscocanadafr.wordpress.com/">French</a></li>

  </div>
    <div class = "col_2">
    <li><a href="https://gblogs.cisco.com/fin/">Finland</a>
    <li><a href="https://gblogs.cisco.com/fr/">France</a>

  <li><a href="https://gblogs.cisco.com/de">Germany</a></li>
  <li><a href="https://gblogs.cisco.com/gr/">Greece</a>
  <li><a href="https://gblogs.cisco.com/in">India</a></li>
  <li><a href="https://gblogs.cisco.com/it/">Italy</a></li>
  <li><a href="https://gblogs.cisco.com/jp/">Japan</a></li>
  <li><a href="https://ciscokrblog.com/">Korea</a></li>

  </div>
  <div class = "col_3">
  <li><span class = "sub_main">Latin America</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/la/">Latin America (Esp)</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/cansac/">Cansac</a></li>
  <li><a href="https://gblogs.cisco.com/nl/">Netherlands</a></li>
  <li><a href="https://gblogs.cisco.com/no">Norway</a></li>
  <li><a href="https://gblogs.cisco.com/pl">Poland</a></li>
  <li><a href="https://gblogs.cisco.com/pt">Portugal</a></li>
  <li><a href="https://gblogs.cisco.com/ro">Romania</a></li>
  </div>

  <div class = "col_4">
  <li><a href="https://gblogs.cisco.com/ru">Russia</a></li>
  <li><a href="https://gblogs.cisco.com/es">Spain</a></li>
  <li><span class = "sub_main">Switzerland</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-tech/">English</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-fr/">French</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-de/">German</a></li>
  <li><a href="https://gblogs.cisco.com/tr/">Turkey</a></li>
  <li><a href="https://gblogs.cisco.com/uki/">UK &amp; Ireland</a></li>
</div>
<div class = "clear"></div>
</ul>
</li>
      </ul>
</nav>
</div>
<footer class = "sb-slide">
	<section id = "footer_content">
				<ul id = "footer_social">
			<li class = "footer_social_title">Connect</li>

			<li><a target='_blank' href='https://www.facebook.com/ciscosecurity?ref=nf'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_fb.png" height = "25" width = "25"></a></li>
			<li><a target='_blank' href='https://twitter.com/ciscosecurity'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_tw.png"></a></li>
			<li><a target='_blank' href='http://www.linkedin.com/company/cisco'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_li.png"></a></li>
			<li><a target='_blank' href='https://plus.google.com/106092229730683979920'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_gp.png"></a></li>
			<div class = "clear"></div>

		</ul>


		<section id="footer_new">
			<ul>
				<li><a href="https://www.cisco.com/web/siteassets/contacts/index.html">Contacts</a>  |  </li>
				<li><a href="https://secure.opinionlab.com/ccc01/o.asp?id=jBjOhqOJ">Feedback</a>  |  </li>
				<li><a href="https://www.cisco.com/web/help/index.html">Help</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/sitemap/index.html">Site Map</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/terms_condition.html">Terms &amp; Conditions</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/privacy.html">Privacy Statement</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/privacy.html#cookies">Cookie Policy</a>  |  </li>
    	 		<li><a href="https://www.cisco.com/web/siteassets/legal/trademark.html">Trademarks</a> <br /> </li>
    	 	</ul>
		</section>
		<br class="clear" />
    	<section id ="disclaimer">
    		<b>Legal Disclaimer</b>
			<p>Some of the individuals posting to this site, including the moderators, work for Cisco Systems. Opinions expressed here and in any corresponding comments are the personal opinions of the original authors, not of Cisco. The content is provided for informational purposes only and is not meant to be an endorsement or representation by Cisco or any other party. This site is available to the public. No information you consider confidential should be posted to this site. By posting you agree to be solely responsible for the content of all information you contribute, link to, or otherwise upload to the Website and release Cisco from any liability related to your use of the Website. You also grant to Cisco a worldwide, perpetual, irrevocable, royalty-free and fully-paid, transferable (including rights to sublicense) right to exercise all copyright, publicity, and moral rights with respect to any original content you provide. The comments are moderated. Comments will appear as soon as they are approved by the moderator.</p>
    	</section>
	</section>
	<script>
var ajaxurl = "https://blogs.cisco.com/wp-admin/admin-ajax.php";
jQuery(document).ready(function($) {

	$('a.commentLikeButton').click(function(event){
		var elemId = event.target.id;
		var commentId = elemId.replace('clickLike','');

		event.preventDefault();

		var nitroID= $(this).attr("data-nitro");



		var str = $(this).text();
		if (str =='1 like') {
			var total = str.replace('like','');
		}
		else {
			var total = str.replace('likes','');
		}
		if ($(this).hasClass( "commentlike")) {
			var theTotal = parseInt(total);
   			theTotal1 = Number(theTotal) + 1;
   			if (theTotal1 === 1){
   				$(this).text(theTotal1+" like"); 
   			}
   			else {
    			$(this).text(theTotal1+" likes");
    		}
    		var data = {
        		'action': 'addLike',
				'commentID': commentId,
				'total': theTotal1
			};


			$.post(ajaxurl, data, function(response) {
				if (typeof nitroID !== 'undefined') {
					commentLike(nitroID);
				}
				commentLiked();
			});

    	}
    	else{
    		$(this).removeAttr("href");
    		alert('You already liked this');
    		/*var theTotal = parseInt(total);
   			theTotal = Number(theTotal) - 1;
   			if (theTotal == 1){
   				$(this).text(theTotal+" like");
   			}
   			else {
    			$(this).text(theTotal+" likes");
    		}
    		var data = {
        		'action': 'removeLike',
				'commentID': commentId,
				'total': theTotal
			};
			$.post(ajaxurl, data, function(response) {
				alert('disliked');
			});*/
    	}

    	$(this).addClass('commentliked').removeClass('commentlike');
	});
});





	</script>
	
	<script>
		var ajaxurl = "https://blogs.cisco.com/wp-admin/admin-ajax.php";
		
		jQuery(document).ready(function($) {
			var postID = 203322;
			var orig_count = 2;
			$(".twitter a").click(function() {

				var theTotal = orig_count;
   				var count = Number(theTotal) + 1;
				var data = {
        			'action': 'addtweet',
					'postID': postID,
					'total': count
				};
				$.post(ajaxurl, data, function(response){});
			})
		});
	</script>

<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/comment-reply.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/wp-embed.min.js?ver=4.9.2'></script>
</footer>
<script>//nitro.refreshNML();</script>




</body>
</html>

  <div id="share_bar1">

    <span class = "share_title">Share</span>
    <div class="twitter sharrre">
      <div class = "box">
        <div class = "count twitcount"></div>
        <a class = "twitclick" href="https://twitter.com/intent/tweet?url=http://bit.ly/2ctl1Rp&text=H1N1: Technical analysis reveals new capabilities&via=ciscosecurity" data-config-metrics-group='social_shares' data-config-metrics-title='twitter_shares' data-config-metrics-item='twitter_share'>tweet</a>
      </div>
    </div>

    <div class="facebook sharrre">
      <div class = "box">
        <div class = "count fbcount"></div>
        <a class = "fbclick share" href = "http://www.facebook.com/sharer/sharer.php?u=https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities&title=H1N1: Technical analysis reveals new capabilities" data-config-metrics-group='social_shares' data-config-metrics-title='facebook_shares' data-config-metrics-item='facebook_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>


    <div class="linkedin sharrre">
      <div class = "box">
        <div class = "count licount"></div>
        <a class = "liclick share" href = "https://www.linkedin.com/cws/share?url=https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='linkedin_shares' data-config-metrics-item='linkedin_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>


      </div>
    </div>

    <div class="googleplus sharrre">
      <div class = "box">
        <div class = "count gpcount"></div>
        <a class = "gpclick share" href="https://plus.google.com/share?url=https://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='google_shares' data-config-metrics-item='google_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>
        <div class = "share_mail"><a class="email emclick" href="mailto:?subject=Cisco Blog: H1N1: Technical analysis reveals new capabilities&body=I saw this post on Cisco Security blog and thought you might like to read it.%0A%0AH1N1: Technical analysis reveals new capabilities%0A%0Ahttps://blogs.cisco.com/security/h1n1-technical-analysis-reveals-new-capabilities%0A%0A****Disclaimer****%0A%0ACisco is not responsible for the content of this email, and its contents do not necessarily reflect Cisco’s views or opinions. Cisco has not verified the email address or name of the sender." data-config-metrics-group='social_shares' data-config-metrics-title='email_shares' data-config-metrics-item='email_share'></a></div>
    <div class = "clear"></div>
  </div>
  