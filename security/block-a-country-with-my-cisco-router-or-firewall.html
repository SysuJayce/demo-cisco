<!DOCTYPE html>

<html lang="eng-US" xmlns:nitro="https://www.bunchball.com/nitro">

<head>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<title>  Block a country with my Cisco Router or Firewall</title>

	<meta property="og:image" content=""/><meta property="og:description" content="We are often asked by customers about how they can prevent traffic from a certain country (let\'s say country X) from entering their network. The motivations for doing this could vary. Sometimes a company does not do business with all countries in the world; therefore, the company doesn\'t need to be accessible from all countries. Other times it is an issue of trust and security, where an administrator may not want to allow country X to enter their infrastructure. Finally, there are cases where country X has often been incriminated with malicious activity, so an administrator may want to block country X when there is no need for the organization to interact with this country."/><meta name="description" content="We are often asked by customers about how they can prevent traffic from a certain country (let\'s say country X) from entering their network. The motivations for doing this could vary. Sometimes a company does not do business with all countries in the world; therefore, the company doesn\'t need to be accessible from all countries. Other times it is an issue of trust and security, where an administrator may not want to allow country X to enter their infrastructure. Finally, there are cases where country X has often been incriminated with malicious activity, so an administrator may want to block country X when there is no need for the organization to interact with this country."/>	<meta property="og:site_name" content="blogs@Cisco - Cisco Blogs"/>

	<meta name="google-site-verification" content="9MlQU9MMQ1jHLMUkONKe6QzZ-ZIGRv0BCD1_rY1Zdmc" />

		<meta name="bitly-verification" content="25789e2a57d8"/>

	<meta name="accessLevel" content="GUEST, CUSTOMER, PARTNER"/>

	<meta name="language" content="en"/>

	<meta name="country" content="US"/>

	<meta name="contentType" content="ciscoBlogs"/>

			<meta name="docType" content="blogPost" />

		<link rel="stylesheet" href="https://blogs.cisco.com/wp-content/themes/cisco_responsive/style.css" type="text/css" media="screen" />

	<link rel="alternate" type="application/rss+xml" title="Cisco Blog RSS Feed" href="https://blogs.cisco.com/feed" />

	<link rel="shortcut icon" href="https://blogs.cisco.com/wp-content/themes/cisco_responsive/favicon.ico" />

	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">



	<link rel='dns-prefetch' href='//www.cisco.com' />
<link rel='dns-prefetch' href='//platform.twitter.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Cisco Blog &raquo; Block a country with my Cisco Router or Firewall Comments Feed" href="https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blogs.cisco.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='css-css'  href='https://blogs.cisco.com/wp-content/plugins/bunchball/bunchball.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='normalize-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/normalize.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='slidebarsstyle-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/slidebars.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='single-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/styles/single.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='codecolorer-css'  href='https://blogs.cisco.com/wp-content/plugins/codecolorer/codecolorer.css?ver=0.9.14' type='text/css' media='screen' />
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/jquery/jquery.js?ver=3.3.1'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.0.0'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/bunchball.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/jquery.cookie.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/jquery.slimscroll.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/moment.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/livestamp.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/modernizr.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/slidebars.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.lazyload.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/theme_script.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://www.cisco.com/assets/swa/j/blogs.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://www.cisco.com/c/dam/cdc/t/ctm.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.tools.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.tipTip.minified.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.sharrre.min.js?ver=4.9.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var single_script_vars = {"ajax_url":"https:\/\/blogs.cisco.com\/wp-admin\/admin-ajax.php","post_id":"61149"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/single.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=4.9.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.cisco.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.cisco.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='What every IT Professional should know about Manufacturing and Production System Plant Floor Networks' href='https://blogs.cisco.com/manufacturing/what-every-it-professional-should-know-about-manufacturing-and-production-system-plant-floor-networks' />
<link rel='next' title='Collaboration is Hot &#8230; A Report from Social Media Week' href='https://blogs.cisco.com/ciscoit/collaboration-is-hot-a-report-from-social-media-week' />

<link rel="canonical" href="https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall" />
<link rel='shortlink' href='https://blogs.cisco.com/?p=61149' />

<!-- START - Twitter Cards, G+, Facebook Tags 2.2.3.1 -->
 <!-- Facebook Open Graph -->
  <meta property="og:locale" content="en_US"/>
  <meta property="og:title" content="Block a country with my Cisco Router or Firewall"/>
  <meta property="og:url" content="https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2012-02-15T12:47:36+00:00"/>
  <meta property="article:modified_time" content="2012-02-20T13:04:34+00:00" />
  <meta property="og:updated_time" content="2012-02-20T13:04:34+00:00" />
  <meta property="article:section" content="Security"/>
  <meta property="article:publisher" content="https://www.facebook.com/Cisco"/>
 <!-- Google+ / Schema.org -->
 <!-- Twitter Cards -->
  <meta name="twitter:title" content="Block a country with my Cisco Router or Firewall"/>
  <meta name="twitter:url" content="https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall"/>
  <meta name="twitter:description" content="We are often asked by customers about how they can prevent traffic from a certain country (let&#039;s say country X) from entering their network. The motivations for doing this could vary. Sometimes a company does not do business with all countries in the world; therefore, the company doesn&#039;t need to be"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:site" content="@Cisco"/>
 <!-- SEO -->
 <!-- Misc. tags -->
 <!-- is_singular -->
<!-- END - Twitter Cards, G+, Facebook Tags 2.2.3.1 -->
	




</head>

<body>

	<div id = "rewards_fix"></div>

	<script src="//assets.bunchball.net/scripts/nitro/current/nitro.js" type="text/javascript"></script>	<script>
		var apiKey = "6912c6c82ccc4863a0311dc8b586b8fb";
		var userId = "anon";
		var time = "1521513956";
		var sig = "2a36d6be388ef38cdb5650c48fb42d2c";
		var connectionParams={};
    		connectionParams.apiKey = apiKey ;
    		connectionParams.timeStamp = time;
    		connectionParams.signature = sig;
    		connectionParams.server =  "//CiscoSupportCommunities2.nitro.bunchball.net/nitro/json/";
    		connectionParams.userId = userId;
    	var nitro = new Nitro(connectionParams);
    	nitro.showPendingNotifications();
	</script> <header class = "sb-slide">
        <div id = "hero">
            <div class = "top_third">
                <div id="hamburger" class = "sb-open-left">
                    <i class="fa fa-bars"></i>
                </div>
            </div>
            <div class = "top_third">
                <div id = "cisco_logo">
                    <div class="dropdown">
                        <div class = "logo_hover"></div>
                        <div class="dropdown-content">
                            <ul>
                                <li><a href = "https://cisco.com">All of Cisco</a></li>
                                <li><a href = "https://blogs.cisco.com">Blogs Home</a></li>
                            </ul>
                         </div>
                    </div>
                </div>
            </div>
            <div class = "hero_header_text">Cisco Blogs</div>
                <div id = "mobile_search_top">
                    <i class="fa fa-search"></i>
                </div>

                <a class = "top_login" href = "https://socialrewards-prod.cloudapps.cisco.com/">Log In to Cisco.com</a>
                
                <div id = "normal_search">
                    <div id = "normal_search_box"><form method="get" id="searchform" action="https://blogs.cisco.com/">

	<input type="text" value=""

    	name="s" id="s">

    </input>

<input type="submit" value=" " class="searchSubmit"/>

</form>

</div>
                        <i class="fa fa-search"></i>
                    <div class = "clear"></div>
                </div>
            <div class = "clear"></div>
            <div id = "normal_menu">
                <nav>
  <a class = "hamburger_login" href = "https://blogs.cisco.com:9031/sp/startSSO.ping?PartnerIdpId=cloudsso.cisco.com">Log In to Cisco.com</a>      <ul>
                  <li><a href='https://blogs.cisco.com'><span>All Blogs</span></a></li>
                  <li><a href='#'><span>Technologies</span></a>
                  <ul>
            <div class = "bordertop"></div>
            <li><a href="https://blogs.cisco.com/analytics-automation">Analytics &amp; Automation</a></li>
            <li><a href="https://blogs.cisco.com/cloud">Cloud</a></li>
            <li><a href='https://blogs.cisco.com/collaboration'>Collaboration</a></li>
            <li><a href='https://blogs.cisco.com/datacenter'>Data Center</a></li>
            <li><a href='https://blogs.cisco.com/digital'>Digital Transformation</a></li>
            <li><a href='https://blogs.cisco.com/enterprise'>Enterprise Networks</a></li>
            <li><a href='https://blogs.cisco.com/innovation'>Innovation</a></li>
            <li><a href='https://blogs.cisco.com/wireless'>Mobility</a></li>
            <li><a href='https://blogs.cisco.com/security'>Security</a></li>
            <li class = "sub"><a href="https://blogs.cisco.com/talos" class="nav_menu" title="">Threat Research</a></li>
            <li><a href='https://blogs.cisco.com/smallbusiness'>Small Business</a></li>
            <li><a href='https://blogs.cisco.com/services'>Services</a></li>
            <li><a href='https://blogs.cisco.com/sp'>SP360:Service Provider</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Industries</span></a>
                      <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/education'>Education</a></li>
            <li><a href='https://blogs.cisco.com/energy'>Energy</a></li>
            <li><a href='https://blogs.cisco.com/financialservices'>Financial Services</a></li>
            <li><a href='https://blogs.cisco.com/government'>Government</a></li>
            <li><a href='https://blogs.cisco.com/healthcare'>Healthcare</a></li>
            <li><a href='https://blogs.cisco.com/manufacturing'>Manufacturing</a></li>
            <li><a href='https://blogs.cisco.com/retail'>Retail &amp; Hospitality</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Partners</span></a> 
          <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/partner'>Partner</a></li>
          </ul>
        </li>
        <li><a href='#'><span>For the Tech Expert</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/getyourbuildon'>Architects &amp; Distinguished Engineers</a></li>
            <li><a href='https://blogs.cisco.com/developer'>Developer</a></li>
            <li><a href='https://blogs.cisco.com/performance'>High Performance Computing</a></li>
            <li><a href='https://blogs.cisco.com/ciscoit'>Inside Cisco IT</a></li>
            <li><a href='https://blogs.cisco.com/cin'>TechWiseTV</a></li>
          </ul>
        </li>
         <li><a href='#'><span>Get to Know Cisco</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/csr'>Corporate Social Responsibility</a></li>
            <li><a href='https://blogs.cisco.com/cle'>Connected Life Exchange</a></li>
            <li><a href='https://blogs.cisco.com/customerstories'>Customer Stories</a></li>
            <li><a href='https://blogs.cisco.com/socialmedia'>Digital and Social Media</a></li>
            <li><a href='https://blogs.cisco.com/gov'>High Tech Policy</a></li>
            <li><a href='https://blogs.cisco.com/diversity'>Inclusion and Diversity</a></li>
            <li><a href='https://blogs.cisco.com/lifeatcisco'>Life at Cisco</a></li>
            <li><a href='https://blogs.cisco.com/perspectives'>Perspectives</a></li>
            <li><a href='https://blogs.cisco.com/news'>Executive Platform: News &amp; Insights</a></li>
          </ul>
        </li>
        <li class = "countries"><a href='#'><span>Countries and Regions</span></a>
          <ul>
            <div class = "col_1">
  <li><a href="https://apjc.thecisconetwork.com/">Asia Pacific</a>
  <li><a href="https://gblogs.cisco.com/at/">Austria</a>
  <li><span class = "sub_main">Belgium</span></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be">Dutch</a></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be-fr">French</a></li>
  <li><a href="https://gblogs.cisco.com/br/">Brazil</a>
  <li><span class = "sub_main">Canada</span></li>
    <li class = "sub"><a href="https://canadablog.cisco.com/">English</a></li>
    <li class = "sub"><a href="https://ciscocanadafr.wordpress.com/">French</a></li>

  </div>
    <div class = "col_2">
    <li><a href="https://gblogs.cisco.com/fin/">Finland</a>
    <li><a href="https://gblogs.cisco.com/fr/">France</a>

  <li><a href="https://gblogs.cisco.com/de">Germany</a></li>
  <li><a href="https://gblogs.cisco.com/gr/">Greece</a>
  <li><a href="https://gblogs.cisco.com/in">India</a></li>
  <li><a href="https://gblogs.cisco.com/it/">Italy</a></li>
  <li><a href="https://gblogs.cisco.com/jp/">Japan</a></li>
  <li><a href="https://ciscokrblog.com/">Korea</a></li>

  </div>
  <div class = "col_3">
  <li><span class = "sub_main">Latin America</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/la/">Latin America (Esp)</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/cansac/">Cansac</a></li>
  <li><a href="https://gblogs.cisco.com/nl/">Netherlands</a></li>
  <li><a href="https://gblogs.cisco.com/no">Norway</a></li>
  <li><a href="https://gblogs.cisco.com/pl">Poland</a></li>
  <li><a href="https://gblogs.cisco.com/pt">Portugal</a></li>
  <li><a href="https://gblogs.cisco.com/ro">Romania</a></li>
  </div>

  <div class = "col_4">
  <li><a href="https://gblogs.cisco.com/ru">Russia</a></li>
  <li><a href="https://gblogs.cisco.com/es">Spain</a></li>
  <li><span class = "sub_main">Switzerland</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-tech/">English</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-fr/">French</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-de/">German</a></li>
  <li><a href="https://gblogs.cisco.com/tr/">Turkey</a></li>
  <li><a href="https://gblogs.cisco.com/uki/">UK &amp; Ireland</a></li>
</div>
<div class = "clear"></div>
</ul>
</li>
      </ul>
</nav>
            </div>
            <div id = "mobile_search">
                <div id = "mobile_search_box">
                    <form method="get" id="searchform" action="https://blogs.cisco.com/">

	<input type="text" value=""

    	name="s" id="s">

    </input>

<input type="submit" value=" " class="searchSubmit"/>

</form>

                </div>
        </div>
        </div>  
    </header>
     
        
  <div id="share_bar1">

    <span class = "share_title">Share</span>
    <div class="twitter sharrre">
      <div class = "box">
        <div class = "count twitcount"></div>
        <a class = "twitclick" href="https://twitter.com/intent/tweet?url=http://bit.ly/1FaXs7G&text=Block a country with my Cisco Router or Firewall&via=ciscosecurity" data-config-metrics-group='social_shares' data-config-metrics-title='twitter_shares' data-config-metrics-item='twitter_share'>tweet</a>
      </div>
    </div>

    <div class="facebook sharrre">
      <div class = "box">
        <div class = "count fbcount"></div>
        <a class = "fbclick share" href = "http://www.facebook.com/sharer/sharer.php?u=https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall&title=Block a country with my Cisco Router or Firewall" data-config-metrics-group='social_shares' data-config-metrics-title='facebook_shares' data-config-metrics-item='facebook_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>


    <div class="linkedin sharrre">
      <div class = "box">
        <div class = "count licount"></div>
        <a class = "liclick share" href = "https://www.linkedin.com/cws/share?url=https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='linkedin_shares' data-config-metrics-item='linkedin_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>


      </div>
    </div>

    <div class="googleplus sharrre">
      <div class = "box">
        <div class = "count gpcount"></div>
        <a class = "gpclick share" href="https://plus.google.com/share?url=https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='google_shares' data-config-metrics-item='google_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>
        <div class = "share_mail"><a class="email emclick" href="mailto:?subject=Cisco Blog: Block a country with my Cisco Router or Firewall&body=I saw this post on Cisco Security blog and thought you might like to read it.%0A%0ABlock a country with my Cisco Router or Firewall%0A%0Ahttps://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall%0A%0A****Disclaimer****%0A%0ACisco is not responsible for the content of this email, and its contents do not necessarily reflect Cisco’s views or opinions. Cisco has not verified the email address or name of the sender." data-config-metrics-group='social_shares' data-config-metrics-title='email_shares' data-config-metrics-item='email_share'></a></div>
    <div class = "clear"></div>
  </div>
  <div id="sb-site">
<div id = "main_content">

	<div id = "blog_content">
	<div id = "main_left">

		<article id = "article_post">
			<p class = "breadcrumb">
			<a href=' https://blogs.cisco.com'>Cisco Blog</a> > <a href=' https://blogs.cisco.com/category/security/'>Security</a></p>
					<div id = "post_image"><img src = "https://alln-extcloud-storage.cisco.com/ciscoblogs/category50.png">  					</div>
  					<div id = "post_info">
  						<span class = "post_category">
  							Security  						</span>
						<h1 id="post-61149" class="kindle_title title">Block a country with my Cisco Router or Firewall</h1>
						<div class="author_image"><img class = "img-circle" src = "https://alln-extcloud-storage.cisco.com/ciscoblogs/userphoto/1515174506-bpthumb.jpg"></div><div class="author_rewards_box"></div><div class = "clear"></div><span class = "list_author"><a href="https://blogs.cisco.com/author/panoskampanakis" title="Posts by Panos Kampanakis" rel="author">Panos Kampanakis</a> - February 15, 2012 - 7 Comments      					</span>
      					<br />
      					<br />
      										</div>
					<div class ="clear"></div>
					<div id ="content">
					<h2>Problem:</h2>
<p>We are often asked by customers about how they can prevent traffic from a certain country (let&#8217;s say <font color="red">country X</font>) from entering their <font color="red">network</font>. The motivations for doing this could vary. Sometimes a company does not do business with all countries in the world; therefore, the company doesn&#8217;t need to be accessible from all countries. Other times it is an issue of trust and security, where an administrator may not want to allow <font color="red">country X</font> to enter their infrastructure. Finally, there are cases where <font color="red">country X</font> has often been incriminated with <font color="blue">malicious activity</font>, so an administrator may want to block <font color="red">country X</font> when there is no need for the organization to interact with this country. In this document I present a methodology on how to write a tool that provides the configuration lines to block <font color="red">country X</font>, using your <font color="red">IOS</font> router or ASA/ASASM <font color="red">firewall</font>.<br />
<span id="more-61149"></span></p>
<h2>Available Resources:</h2>
<p>First we need to start by finding the allocated address ranges associated with a country. That information is publicly available by the <a href="https://www.arin.net/knowledge/rirs.html" target="_blank">Regional Internet Registries (<font color="red">RIRs</font>)</a>. Each <font color="red">RIR</font> has a file with the information of the address blocks it has allocated to various countries. A list of the files is shown below:</p>
<ul>
<li><a href="ftp://ftp.arin.net/pub/stats/arin/delegated-arin-latest"><font color="red">ARIN</font></a></li>
<li><a href="ftp://ftp.ripe.net/ripe/stats/delegated-ripencc-latest">RIPE</a></li>
<li><a href="ftp://ftp.afrinic.net/pub/stats/afrinic/delegated-afrinic-latest">AFRINIC</a></li>
<li><a href="ftp://ftp.apnic.net/pub/stats/apnic/delegated-apnic-latest">APNIC</a></li>
<li><a href="ftp://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-latest">LACNIC</a></li>
</ul>
<p>The <font color="red">RIR</font> files also contain registered ASN information for <font color="red">BGP</font>, which is outside the interest of this document. The file lines that we are interested in look like the following snippet:</p>
<pre><font color="red">arin</font>|US|<font color="red">ipv4</font>|8.0.0.0|16777216|19921201|allocated

<font color="red">arin</font>|US|<font color="red">ipv4</font>|9.0.0.0|16777216|19881216|assigned

<font color="red">arin</font>|US|<font color="red">ipv6</font>|2001:400::|32|19990803|allocated

<font color="red">arin</font>|US|<font color="red">ipv6</font>|2001:408::|32|20100202|allocated</pre>
<p>In this example we see that the second column has the <font color="red">country code</font> (US), the third column depicts if the address is <font color="red">IPv4</font> or <font color="red">IPv6</font>, the third has the address block, and the fourth represents the <font color="red">network</font> mask. Note that the mask for <font color="red">IPv4</font> is the decimal value of the <font color="red">IPv4</font> mask, whereas for <font color="red">IPv6</font> we only have the bits of the <font color="red">IPv6</font> mask.</p>
<h2>Tools:</h2>
<p>In order to be able to build a tool that automates the process of creating an <font color="red">access control list</font> (<font color="red">ACL</font>) for traffic from a specific country, we would first need to be able to download all the address maps from the <font color="red">RIR</font> files and consolidate them into one file. For this example I used a bash <font color="red">script</font> to download the files to a file called</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">addr_all_regs</div></div>
<p>that aggregates the addresses. The <font color="red">script</font> is run daily with a Linux</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">cron job</div></div>
<p>in order to have the latest <font color="red">RIR</font> address allocations. The example <font color="red">script</font> code below downloads the <font color="red">ARIN</font> file and appends it to</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">addr_all_regs</div></div>
<p>.</p>
<pre>DIR=/home/mydir

wget -O addr_tmp ftp://ftp.arin.net/pub/stats/arin/delegated-arin-latest

egrep "\|ipv[46]\|" $DIR/addr_tmp &gt;&gt; $DIR/addr_all_regs</pre>
<p>After all the addresses are aggregated into a file, it is a matter of extracting the relevant information that we need in order to create the <font color="red">ACL</font>. I chose to use Perl to parse the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">addr_all_regs</div></div>
<p>file, but other options are available.</p>
<p>The <font color="red">script</font> input options passed to the Perl <font color="red">script</font> are parsed by Perl&#8217;s</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">GetOptions</div></div>
<p>. In my example, I chose to pass the <font color="red">IPv4</font> or <font color="red">IPv6</font> option in the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">prot</div></div>
<p>parameter, the source or destination blocking <font color="red">ACL</font> in the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">d</div></div>
<p>parameter, the <font color="red">country code</font> in the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">c</div></div>
<p>parameter, the product in the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">prod</div></div>
<p>parameter, the object or <font color="red">IP</font> address option in the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">obj</div></div>
<p>parameter, and the help option in the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">help</div></div>
<p>parameter.</p>
<pre>#!/usr/bin/perl

use Getopt::Long;

<span style="color: #339966;"># Process options.provided as arguments to the <font color="red">script</font></span>

if ( @ARGV &gt; 0 ) {

    GetOptions('prot:i' =&gt; \$protocol,

               'd'      =&gt; \$destination,

               'c=s'    =&gt; \$country,

               'prod=s' =&gt; \$product,

               'obj'    =&gt; \$obj,

               'help|h' =&gt; \$help);

  }</pre>
<p>The input options to the <font color="red">script</font> can vary depending on the needs. An IPv4-only <font color="red">ACL</font> for just one product might use the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">prot</div></div>
<p>,</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">prod,</div></div>
<p>and</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">obj</div></div>
<p>parameters.</p>
<p>Note that special care should be taken with passing the <font color="red">country code</font> to the <font color="red">script</font>. ISO 3166 provides the mappings of countries to their <font color="red">country codes</font>.</p>
<p>Converting the mask column in the <font color="red">RIR</font> files to real masks that are used in <font color="red">IPv4</font> <font color="red">ACLs</font> can be tricky. For <font color="red">IPv6</font> <font color="red">ACLs</font>, the bits of the mask suffice to be used in the <font color="red">ACL</font>. For <font color="red">IPv4</font> <font color="red">ACLs</font>, I wrote the following Perl code that takes the <font color="red">IPv4</font> decimal mask and converts it to a wildcard mask for <font color="red">IOS</font> <font color="red">ACLs</font> and to a netmask for <font color="red">ASA</font> <font color="red">ACLs</font>, based on the second <font color="red">function</font> argument. The</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">decv4mask2ipv4mask(x,y)</div></div>
<p>is used in the Perl <font color="red">script</font> that processes the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">addr_all_regs</div></div>
<p>in order to generate the country <font color="red">ACL</font>.</p>
<pre><span style="color: #339966;"># <font color="red">Function</font> that converts a decimal number to a mask or a wildcard # mask 

based on the second <font color="red">function</font> argument</span>

<span style="color: #0000ff;">sub decv4mask2ipv4mask ($) { </span>

  $tmp=33;

  $val=$_[0];

  <span style="color: #339966;"># Shift the decimal one bit at a time to find the MSB</span>

  while ($val &gt; 0) {

        $val = $val &gt;&gt; 1;

        $tmp--;

      }

  $mask=$tmp;

  <span style="color: #339966;"># Start from a zero octet <font color="red">IPv4 address</font></span>

  @<font color="red">ip</font>=(0,0,0,0);

  $index=31;

  <span style="color: #339966;"># For the bits counted above keep shifting adding 1b in the 1st-bit</span>

  while ($tmp &gt; 0) {

        $byte=($index)/8;

        $<font color="red">ip</font>[$byte]=($ip[$byte]&gt;&gt;1)+128;

        $tmp--;

        $index--;

      }

  <span style="color: #339966;"># If the second <font color="red">function</font> argument is 1 then return the wildcard mask</span>

  if ($_[1]) {

     $<font color="red">ip</font>[3]=255-$<font color="red">ip</font>[3]; $<font color="red">ip</font>[2]=255-$<font color="red">ip</font>[2]; $<font color="red">ip</font>[1]=255-$<font color="red">ip</font>[1]; 

$<font color="red">ip</font>[0]=255-$<font color="red">ip</font>[0];

    }

  <span style="color: #339966;"># Else the mask will be returned</span>

  return "$<font color="red">ip</font>[3].$<font color="red">ip</font>[2].$<font color="red">ip</font>[1].$<font color="red">ip</font>[0]";

<span style="color: #0000ff;">} </span></pre>
<h2>Algorithm Flowchart:</h2>
<p>Now we have all the necessary building blocks in order to create our country-based <font color="red">ACL</font>. We have a file (</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">addr_all_regs</div></div>
<p>) that consolidates all the address-block allocations and we have a <font color="red">function</font> that can convert the masks in the file into <font color="red">Cisco</font> <font color="red">ACL</font> masks. The next step is to parse the file based on the user-supplied input and create a country-based <font color="red">ACL</font>. The image below shows the flowchart of the algorithm I implemented (in Perl) in order to generate the access list.</p>
<p style="text-align: center;"><a href="https://alln-extcloud-storage.cisco.com/ciscoblogs/AlgorithmFlowDiagram1.bmp" target="_blank"><img class="size-medium wp-image-8098 aligncenter" title="flowchart" src="https://alln-extcloud-storage.cisco.com/ciscoblogs/AlgorithmFlowDiagram1.bmp" alt="" width="575" height="340" /></a></p>
<p>When parsing the consolidated file for a country, it is important to be able to determine if the country is not present in the address file. If not, then the result should throw a notification to let the user know that this <font color="red">country code</font> did not exist and potentially investigate it.</p>
<p>Also, when generating the <font color="red">ACL</font> it is significant to note the syntactical differences between IOS/IOS-XE, IOS-XR, and <font color="red">ASA</font> <font color="red">ACLs</font>, and the differences between <font color="red">IPv4</font> and <font color="red">IPv6</font> <font color="red">ACLs</font>. Even though they are all very similar, there are slight <font color="red">CLI</font> differences between different products. The syntax can be found in the following product configuration guides:</p>
<ul>
<li><a href="http://www.cisco.com/en/US/docs/security/asa/asa84/configuration/guide/acl_extended.html" target="_blank"><font color="red">ASA</font> <font color="red">IPv4</font></a> and <a href="http://www.cisco.com/en/US/docs/security/asa/asa84/configuration/guide/acl_ipv6.html" target="_blank"><font color="red">ASA</font> <font color="red">IPv6</font></a> <font color="red">ACLs</font></li>
<li><a href="http://www.cisco.com/en/US/docs/ios-xml/ios/sec_data_acl/configuration/15-1mt/Creating_an_IP_Access_List_and_Applying_It_to_an_Interface.html" target="_blank">IOS/IOX-XE <font color="red">IPv4</font></a> and <a href="http://www.cisco.com/en/US/docs/ios-xml/ios/ipv6/configuration/15-1mt/ip6-sec-trfltr-fw.html" target="_blank">IOS/IOS-XE <font color="red">IPv6</font></a> <font color="red">ACLs</font></li>
<li><a href="http://www.cisco.com/en/US/docs/ios_xr_sw/iosxr_r3.7/addr_serv/configuration/guide/ic37alpl.html" target="_blank">IOS-XR</a> <font color="red">ACLs</font></li>
</ul>
<h2>Alternative:</h2>
<p>Sometimes, it can be time consuming to write an entire program that does the processing to create the <font color="red">ACL</font>. Thus manual work can often save a lot of time. For that reason, a simple</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">cat addr_all_regs | grep &quot;[<font color="red">country code</font>]\|[<font color="red">ipv4</font> or <font color="red">ipv6</font>]&quot;</div></div>
<p>for the country and the <font color="red">IPv4</font> or <font color="red">IPv6</font> from the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">addr_all_regs</div></div>
<p>will give the output we desire. Then extracting the columns with addresses and the masks can practically bring us almost to the solution. Converting the address block/netmask pair into an <font color="red">ACL</font> line is trivial using various text editors. So, if writing a whole program to process the</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">addr_all_regs</div></div>
<p>file is not what you want to do, you can also use</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">grep</div></div>
<p>for the information that you require from the file and create the <font color="red">ACL</font> manually by editing the text.</p>
<p>Other alternatives could include downloading and using <a href="http://www.maxmind.com/app/geoip_country" target="_blank">MaxMind&#8217;s GEOLite Location database</a> in order to parse it and extract the information needed.</p>
<h2>Considerations:</h2>
<p>Even if someone does find it useful to be able to block a country from their <font color="red">network</font> using the above methods, I must say that the methodology presented above is not entirely bulletproof. There are cases where it would not work. One such case would be for addresses that are inaccurately documented. For example, we have seen address blocks from European countries that are listed under country EU instead of the actual country. In that case, these addresses appear to belong to country EU and would not be caught by the <font color="red">ACL</font> that is denying <font color="red">country X</font>.</p>
<p>Another case where the above method would fail is when users use anonymizer services. For example, if a user is located in country X and wants to reach organization Y—which is utilizing an <font color="red">ACL</font> to block <font color="red">country X</font>—the user could still try to use an anonymizer service (there are many available) that practically acts as a proxy. The user would no longer appear to be originating from <font color="red">country X</font>, but instead appear to be originating from the country where the anonymizer is located. That way the <font color="red">ACL</font> blocking <font color="red">country X</font> could be bypassed.</p>
<h2>Summary:</h2>
<p>Building a tool that writes country-blocking <font color="red">ACLs</font> involves downloading the country address allocations from various <font color="red">RIRs</font>. After parsing the files and keeping the block allocations, the corresponding <font color="red">IPv4</font> and <font color="red">IPv6</font> blocks—with their masks—can be inserted into an <font color="red">ACL</font> that is generated for <font color="red">IPv4</font> and <font color="red">IPv6</font> respectively. The <font color="red">ACL</font> can then be used to block traffic or to match it for further processing or investigation. However, attention should be paid to the caveats of the method.</p>
<p>Many might ask <strong>&#8220;Where is the tool?&#8221;</strong> that I built. This was a tool built for custom use, it was not built to be provided to customers and is not officially supported. Thus, at this time the tool will not be released. I believe that following the suggestions made in the post, it shouldn&#8217;t be too complicated to build your own automated tool that can provide the necessary blocks, in order to write an <font color="red">ACL</font> to match on a specific country.</p>
Tags:<br /><ul class = "tagged"><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=asa">ASA</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=firewall">firewall</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=internet-traffic">internet traffic</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=ios">IOS</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=mitigations">mitigations</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=security-2">security</a></li></ul>		</div>
			<div id = "comments">
				<div id = "respond">
				<p class = "cisco_respond">In an effort to keep conversations fresh, Cisco Blogs closes comments after 60 days. Please visit the <a href ="https://blogs.cisco.com">Cisco Blogs hub page</a> for the latest content.</p>
			<p><span class = "comment_heading">7 Comments</span></p>
		<ol class="commentlist" id="thecomments">
				
			<li>
			<div id="comment-584777">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						Panos						</span>
						<br />
						<span class="comment-meta commentmetadata">April 25, 2012 at 9:02 am</span>

					</div>
				<div class="comment_text">
				<p>Eng,



The RIR files have ipv6 addresses in the format 



arin|US|ipv6|2001:400::|32|19990803|allocated



So, if you consolidate all the RIR files that I talk about in the post in one file and grep for "\|ipv6" you will get all the IPv6 addresses for this country. Using the right country code is important.



Regards,

Panos</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike584777" class = "commentLikeButton commentlike" data-nitro = >0 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-584662">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						Eng Simon						</span>
						<br />
						<span class="comment-meta commentmetadata">April 25, 2012 at 3:14 am</span>

					</div>
				<div class="comment_text">
				<p>Is there any way to find out the IPv6 addresses block by country?</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike584662" class = "commentLikeButton commentlike" data-nitro = >0 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-556559">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						Panos						</span>
						<br />
						<span class="comment-meta commentmetadata">March 4, 2012 at 6:55 pm</span>

					</div>
				<div class="comment_text">
				<p>Hi Zoly,



Good point. This tool will not prevent against proxied traffic. I tried to explain it in the "Considerations" section. 



If we are talking about web traffic that is proxied, then other means like content aware filtering may help. If the concern is spoofed DDoS traffic then measure like Anomaly detection and RTBH could protect against anomalous spoofed packets from Bots.



Panos</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike556559" class = "commentLikeButton commentlike" data-nitro = >0 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-556393">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						Zoly Szasz						</span>
						<br />
						<span class="comment-meta commentmetadata">March 4, 2012 at 8:56 am</span>

					</div>
				<div class="comment_text">
				<p>And what would somebody do about proxy servers? This restrictions has to be at a higher level to be effective I think.</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike556393" class = "commentLikeButton commentlike" data-nitro = >0 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-553984">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						J. Warren						</span>
						<br />
						<span class="comment-meta commentmetadata">February 26, 2012 at 9:43 am</span>

					</div>
				<div class="comment_text">
				<p>• https://blogs.msdn.com/themes/blogs/generic/post.aspx?WeblogApp=alexhomer&amp;y=2011&amp;m=02&amp;d=06&amp;WeblogPostName=blocking-malware-domains-in-isa-2006&amp;GroupKeys=

"... malware that connects using an IP address instead of a domain name will -not- be blocked when you use just domain name lists..."

.</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike553984" class = "commentLikeButton commentlike" data-nitro =>1 like</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-550248">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						<a href='http://www.master.cz' rel='external nofollow' class='url'>Martin Zidek</a>						</span>
						<br />
						<span class="comment-meta commentmetadata">February 16, 2012 at 1:12 pm</span>

					</div>
				<div class="comment_text">
				<p>Or you can use preprocesed country blocks from http://www.ipdeny.com/ipblocks/, we use them for blocking attacks from China.</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike550248" class = "commentLikeButton commentlike" data-nitro = >4 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-549978">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						<a href='http://Infornatic' rel='external nofollow' class='url'>Edgar Glz</a>						</span>
						<br />
						<span class="comment-meta commentmetadata">February 16, 2012 at 5:47 am</span>

					</div>
				<div class="comment_text">
				<p>Good Post!</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike549978" class = "commentLikeButton commentlike" data-nitro = >0 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->
			</ol>
	</div>

			</div>
		</article>

	</div>
	<div id = "main_right">
		<ul id = "sidebar">

  <li id="subscribe" class="widget">
    <h3>Subscribe to Security:</h3>
    <div id="subscribe_box">
      <form id ="subscribe_form" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=CiscoBlogSecurity', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
        <input type="text" class="subscribe" name="email" value="Enter email address" onFocus="if(this.value == 'Enter email address') {this.value = '';}" onBlur="if (this.value == '') {this.value = 'Enter email address';}"></input>
        <input type="hidden" value="CiscoBlogSecurity" name="uri" ></input>
        <input type="hidden" name="loc" value="en_US"></input>
        <input type="submit" class="subscribe_button" value="Subscribe" ></input>
        <div class="clear"></div>
      </form>
    </div>
    <div class="clear"></div>

</li>

<li id="social_widget" class="widget">
  <h3>Connect with Security</h3>
  <ul>
        <li><a target='_blank' href="https://www.facebook.com/ciscosecurity?ref=nf"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_fb.png" alt="Facebook"></a></li>
    <li><a target='_blank' href="https://twitter.com/ciscosecurity"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_tw.png" alt="Twitter"></a></li>
    <li><a target='_blank' href="http://www.linkedin.com/company/cisco"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_li.png" alt="Linkedin"></a></li>
    <li><a target='_blank' href="https://plus.google.com/106092229730683979920"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_gp.png" alt="Google+"></a></li>
    <li><a target='_blank' href="https://www.slideshare.net/ciscosystems"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_ss.png" alt="Slideshare"></a></li>
    <li><a target='_blank' href="http://youtubecisco.com/security"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_yt.png" alt="YouTube"></a></li>
    <li><a target='_blank' href="https://www.instagram.com/cisco/?hl=en"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_ig.png" alt="Instagram"></a></li>
    <li><a href="https://feeds.feedburner.com/CiscoBlogSecurity"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/rss.png" width = "24" height = "24" alt = "Rss"></a></li>
      </ul>
</li>
	<li>
		<div id = "nitroLoggedOut" class="widget">
			<div class = "consoleTitle">
				Cisco Social Rewards
			</div>
			<div class = "consoleTextNoLog">
				Get credit for all your Cisco site participation with Social Rewards. <a href = "https://blogs.cisco.com/rewards-about">Learn More</a>			</div>
						<a href = "https://socialrewards-prod.cloudapps.cisco.com/" class = "joinNow">Join Today</a>
			<div class = "consoleTextNoLog">
				Already a member?  <a href = "https://socialrewards-prod.cloudapps.cisco.com/" class = "already">Log In</a>
			</div>
			</div>
</li> 	<script>


	nitro.callAPI("method=site.getActionFeed&apiKey=6912c6c82ccc4863a0311dc8b586b8fb&showLevelChanges=true&preferences=userFullName|profileUrl|userPhotoUrl", "newsfeed");
	</script>
	<li>
		 <div id ="newsfeedWidget">
			<div class = "newsfeed_header">
				Latest Rewards
				<a href = "https://blogs.cisco.com/rewards-about" class = "newsIcon"><img src = "/wp-content/plugins/bunchball/images/infoIcon.png"></a>
			</div>
			<div id = "newsInnerContent">
				<ul id = "newsfeed">
				</ul>
			</div>
		</div>
	</li>
    <li id="blogroll">
            <ul id="blogroll_links">
          <li class="roll_heading">What We're Reading</li>

            <li><a href="http://www.cert.org/blogs/vuls/" target="_blank">CERT Vulnerability Analysis</a></li>
                      <li><a href="http://blogs.technet.com/b/srd/" target="_blank">Microsoft Security Research & Defense</a></li>
                      <li><a href="http://isc.sans.edu/index.html" target="_blank">SANS Internet Storm Center</a></li>
                      <li><a href="http://www.schneier.com/" target="_blank">Schneier on Security</a></li>
                  </ul>
              <ul id="related_links">
          <li class="roll_heading">Related Links</li>
                    <li><a href="http://www.cisco.com/en/US/products/products_security_advisories_listing.html" target="_blank">Advisories and Responses</a></li>
                        <li><a href="http://tools.cisco.com/security/center/cyberRiskReport.x" target="_blank">Cyber Risk Reports</a></li>
                        <li><a href="http://tools.cisco.com/security/center/intelliPapers.x?i=55" target="_blank">Security Best Practices</a></li>
                        <li><a href="http://tools.cisco.com/security/center/home.x" target="_blank">Security Intelligence Operations</a></li>
                        <li><a href="http://www.cisco.com/en/US/products/hw/vpndevc/index.html" target="_blank">Security Products</a></li>
                  </ul>
          </li>
  </ul>	</div>
	<div class = "clear"></div>
</div>
</div>
</div>
   

<div class="sb-slidebar sb-left sb-width-custom sb-momentum-scrolling " data-sb-width="50%">
    <nav>
  <a class = "hamburger_login" href = "https://blogs.cisco.com:9031/sp/startSSO.ping?PartnerIdpId=cloudsso.cisco.com">Log In to Cisco.com</a>      <ul>
                  <li><a href='https://blogs.cisco.com'><span>All Blogs</span></a></li>
                  <li><a href='#'><span>Technologies</span></a>
                  <ul>
            <div class = "bordertop"></div>
            <li><a href="https://blogs.cisco.com/analytics-automation">Analytics &amp; Automation</a></li>
            <li><a href="https://blogs.cisco.com/cloud">Cloud</a></li>
            <li><a href='https://blogs.cisco.com/collaboration'>Collaboration</a></li>
            <li><a href='https://blogs.cisco.com/datacenter'>Data Center</a></li>
            <li><a href='https://blogs.cisco.com/digital'>Digital Transformation</a></li>
            <li><a href='https://blogs.cisco.com/enterprise'>Enterprise Networks</a></li>
            <li><a href='https://blogs.cisco.com/innovation'>Innovation</a></li>
            <li><a href='https://blogs.cisco.com/wireless'>Mobility</a></li>
            <li><a href='https://blogs.cisco.com/security'>Security</a></li>
            <li class = "sub"><a href="https://blogs.cisco.com/talos" class="nav_menu" title="">Threat Research</a></li>
            <li><a href='https://blogs.cisco.com/smallbusiness'>Small Business</a></li>
            <li><a href='https://blogs.cisco.com/services'>Services</a></li>
            <li><a href='https://blogs.cisco.com/sp'>SP360:Service Provider</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Industries</span></a>
                      <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/education'>Education</a></li>
            <li><a href='https://blogs.cisco.com/energy'>Energy</a></li>
            <li><a href='https://blogs.cisco.com/financialservices'>Financial Services</a></li>
            <li><a href='https://blogs.cisco.com/government'>Government</a></li>
            <li><a href='https://blogs.cisco.com/healthcare'>Healthcare</a></li>
            <li><a href='https://blogs.cisco.com/manufacturing'>Manufacturing</a></li>
            <li><a href='https://blogs.cisco.com/retail'>Retail &amp; Hospitality</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Partners</span></a> 
          <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/partner'>Partner</a></li>
          </ul>
        </li>
        <li><a href='#'><span>For the Tech Expert</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/getyourbuildon'>Architects &amp; Distinguished Engineers</a></li>
            <li><a href='https://blogs.cisco.com/developer'>Developer</a></li>
            <li><a href='https://blogs.cisco.com/performance'>High Performance Computing</a></li>
            <li><a href='https://blogs.cisco.com/ciscoit'>Inside Cisco IT</a></li>
            <li><a href='https://blogs.cisco.com/cin'>TechWiseTV</a></li>
          </ul>
        </li>
         <li><a href='#'><span>Get to Know Cisco</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/csr'>Corporate Social Responsibility</a></li>
            <li><a href='https://blogs.cisco.com/cle'>Connected Life Exchange</a></li>
            <li><a href='https://blogs.cisco.com/customerstories'>Customer Stories</a></li>
            <li><a href='https://blogs.cisco.com/socialmedia'>Digital and Social Media</a></li>
            <li><a href='https://blogs.cisco.com/gov'>High Tech Policy</a></li>
            <li><a href='https://blogs.cisco.com/diversity'>Inclusion and Diversity</a></li>
            <li><a href='https://blogs.cisco.com/lifeatcisco'>Life at Cisco</a></li>
            <li><a href='https://blogs.cisco.com/perspectives'>Perspectives</a></li>
            <li><a href='https://blogs.cisco.com/news'>Executive Platform: News &amp; Insights</a></li>
          </ul>
        </li>
        <li class = "countries"><a href='#'><span>Countries and Regions</span></a>
          <ul>
            <div class = "col_1">
  <li><a href="https://apjc.thecisconetwork.com/">Asia Pacific</a>
  <li><a href="https://gblogs.cisco.com/at/">Austria</a>
  <li><span class = "sub_main">Belgium</span></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be">Dutch</a></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be-fr">French</a></li>
  <li><a href="https://gblogs.cisco.com/br/">Brazil</a>
  <li><span class = "sub_main">Canada</span></li>
    <li class = "sub"><a href="https://canadablog.cisco.com/">English</a></li>
    <li class = "sub"><a href="https://ciscocanadafr.wordpress.com/">French</a></li>

  </div>
    <div class = "col_2">
    <li><a href="https://gblogs.cisco.com/fin/">Finland</a>
    <li><a href="https://gblogs.cisco.com/fr/">France</a>

  <li><a href="https://gblogs.cisco.com/de">Germany</a></li>
  <li><a href="https://gblogs.cisco.com/gr/">Greece</a>
  <li><a href="https://gblogs.cisco.com/in">India</a></li>
  <li><a href="https://gblogs.cisco.com/it/">Italy</a></li>
  <li><a href="https://gblogs.cisco.com/jp/">Japan</a></li>
  <li><a href="https://ciscokrblog.com/">Korea</a></li>

  </div>
  <div class = "col_3">
  <li><span class = "sub_main">Latin America</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/la/">Latin America (Esp)</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/cansac/">Cansac</a></li>
  <li><a href="https://gblogs.cisco.com/nl/">Netherlands</a></li>
  <li><a href="https://gblogs.cisco.com/no">Norway</a></li>
  <li><a href="https://gblogs.cisco.com/pl">Poland</a></li>
  <li><a href="https://gblogs.cisco.com/pt">Portugal</a></li>
  <li><a href="https://gblogs.cisco.com/ro">Romania</a></li>
  </div>

  <div class = "col_4">
  <li><a href="https://gblogs.cisco.com/ru">Russia</a></li>
  <li><a href="https://gblogs.cisco.com/es">Spain</a></li>
  <li><span class = "sub_main">Switzerland</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-tech/">English</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-fr/">French</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-de/">German</a></li>
  <li><a href="https://gblogs.cisco.com/tr/">Turkey</a></li>
  <li><a href="https://gblogs.cisco.com/uki/">UK &amp; Ireland</a></li>
</div>
<div class = "clear"></div>
</ul>
</li>
      </ul>
</nav>
</div>
<footer class = "sb-slide">
	<section id = "footer_content">
				<ul id = "footer_social">
			<li class = "footer_social_title">Connect</li>

			<li><a target='_blank' href='https://www.facebook.com/ciscosecurity?ref=nf'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_fb.png" height = "25" width = "25"></a></li>
			<li><a target='_blank' href='https://twitter.com/ciscosecurity'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_tw.png"></a></li>
			<li><a target='_blank' href='http://www.linkedin.com/company/cisco'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_li.png"></a></li>
			<li><a target='_blank' href='https://plus.google.com/106092229730683979920'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_gp.png"></a></li>
			<div class = "clear"></div>

		</ul>


		<section id="footer_new">
			<ul>
				<li><a href="https://www.cisco.com/web/siteassets/contacts/index.html">Contacts</a>  |  </li>
				<li><a href="https://secure.opinionlab.com/ccc01/o.asp?id=jBjOhqOJ">Feedback</a>  |  </li>
				<li><a href="https://www.cisco.com/web/help/index.html">Help</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/sitemap/index.html">Site Map</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/terms_condition.html">Terms &amp; Conditions</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/privacy.html">Privacy Statement</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/privacy.html#cookies">Cookie Policy</a>  |  </li>
    	 		<li><a href="https://www.cisco.com/web/siteassets/legal/trademark.html">Trademarks</a> <br /> </li>
    	 	</ul>
		</section>
		<br class="clear" />
    	<section id ="disclaimer">
    		<b>Legal Disclaimer</b>
			<p>Some of the individuals posting to this site, including the moderators, work for Cisco Systems. Opinions expressed here and in any corresponding comments are the personal opinions of the original authors, not of Cisco. The content is provided for informational purposes only and is not meant to be an endorsement or representation by Cisco or any other party. This site is available to the public. No information you consider confidential should be posted to this site. By posting you agree to be solely responsible for the content of all information you contribute, link to, or otherwise upload to the Website and release Cisco from any liability related to your use of the Website. You also grant to Cisco a worldwide, perpetual, irrevocable, royalty-free and fully-paid, transferable (including rights to sublicense) right to exercise all copyright, publicity, and moral rights with respect to any original content you provide. The comments are moderated. Comments will appear as soon as they are approved by the moderator.</p>
    	</section>
	</section>
	<script>
var ajaxurl = "https://blogs.cisco.com/wp-admin/admin-ajax.php";
jQuery(document).ready(function($) {

	$('a.commentLikeButton').click(function(event){
		var elemId = event.target.id;
		var commentId = elemId.replace('clickLike','');

		event.preventDefault();

		var nitroID= $(this).attr("data-nitro");



		var str = $(this).text();
		if (str =='1 like') {
			var total = str.replace('like','');
		}
		else {
			var total = str.replace('likes','');
		}
		if ($(this).hasClass( "commentlike")) {
			var theTotal = parseInt(total);
   			theTotal1 = Number(theTotal) + 1;
   			if (theTotal1 === 1){
   				$(this).text(theTotal1+" like"); 
   			}
   			else {
    			$(this).text(theTotal1+" likes");
    		}
    		var data = {
        		'action': 'addLike',
				'commentID': commentId,
				'total': theTotal1
			};


			$.post(ajaxurl, data, function(response) {
				if (typeof nitroID !== 'undefined') {
					commentLike(nitroID);
				}
				commentLiked();
			});

    	}
    	else{
    		$(this).removeAttr("href");
    		alert('You already liked this');
    		/*var theTotal = parseInt(total);
   			theTotal = Number(theTotal) - 1;
   			if (theTotal == 1){
   				$(this).text(theTotal+" like");
   			}
   			else {
    			$(this).text(theTotal+" likes");
    		}
    		var data = {
        		'action': 'removeLike',
				'commentID': commentId,
				'total': theTotal
			};
			$.post(ajaxurl, data, function(response) {
				alert('disliked');
			});*/
    	}

    	$(this).addClass('commentliked').removeClass('commentlike');
	});
});





	</script>
	
	<script>
		var ajaxurl = "https://blogs.cisco.com/wp-admin/admin-ajax.php";
		
		jQuery(document).ready(function($) {
			var postID = 61149;
			var orig_count = 0;
			$(".twitter a").click(function() {

				var theTotal = orig_count;
   				var count = Number(theTotal) + 1;
				var data = {
        			'action': 'addtweet',
					'postID': postID,
					'total': count
				};
				$.post(ajaxurl, data, function(response){});
			})
		});
	</script>

<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/comment-reply.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/wp-embed.min.js?ver=4.9.2'></script>
</footer>
<script>//nitro.refreshNML();</script>




</body>
</html>

  <div id="share_bar1">

    <span class = "share_title">Share</span>
    <div class="twitter sharrre">
      <div class = "box">
        <div class = "count twitcount"></div>
        <a class = "twitclick" href="https://twitter.com/intent/tweet?url=http://bit.ly/1FaXs7G&text=Block a country with my Cisco Router or Firewall&via=ciscosecurity" data-config-metrics-group='social_shares' data-config-metrics-title='twitter_shares' data-config-metrics-item='twitter_share'>tweet</a>
      </div>
    </div>

    <div class="facebook sharrre">
      <div class = "box">
        <div class = "count fbcount"></div>
        <a class = "fbclick share" href = "http://www.facebook.com/sharer/sharer.php?u=https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall&title=Block a country with my Cisco Router or Firewall" data-config-metrics-group='social_shares' data-config-metrics-title='facebook_shares' data-config-metrics-item='facebook_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>


    <div class="linkedin sharrre">
      <div class = "box">
        <div class = "count licount"></div>
        <a class = "liclick share" href = "https://www.linkedin.com/cws/share?url=https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='linkedin_shares' data-config-metrics-item='linkedin_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>


      </div>
    </div>

    <div class="googleplus sharrre">
      <div class = "box">
        <div class = "count gpcount"></div>
        <a class = "gpclick share" href="https://plus.google.com/share?url=https://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='google_shares' data-config-metrics-item='google_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>
        <div class = "share_mail"><a class="email emclick" href="mailto:?subject=Cisco Blog: Block a country with my Cisco Router or Firewall&body=I saw this post on Cisco Security blog and thought you might like to read it.%0A%0ABlock a country with my Cisco Router or Firewall%0A%0Ahttps://blogs.cisco.com/security/block-a-country-with-my-cisco-router-or-firewall%0A%0A****Disclaimer****%0A%0ACisco is not responsible for the content of this email, and its contents do not necessarily reflect Cisco’s views or opinions. Cisco has not verified the email address or name of the sender." data-config-metrics-group='social_shares' data-config-metrics-title='email_shares' data-config-metrics-item='email_share'></a></div>
    <div class = "clear"></div>
  </div>
  