<!DOCTYPE html>

<html lang="eng-US" xmlns:nitro="https://www.bunchball.com/nitro">

<head>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<title>  Extracting EXE Drop Malware</title>

	<meta property="og:image" content=""/><meta property="og:description" content="In the last few years there has been a major shift in the vulnerability landscape from a focus on attacking network-based server applications to attacking client applications using malicious file formats. Due to this shift there has been a variety of new techniques developed by attackers for more reliable control post-exploitation."/><meta name="description" content="In the last few years there has been a major shift in the vulnerability landscape from a focus on attacking network-based server applications to attacking client applications using malicious file formats. Due to this shift there has been a variety of new techniques developed by attackers for more reliable control post-exploitation."/>	<meta property="og:site_name" content="blogs@Cisco - Cisco Blogs"/>

	<meta name="google-site-verification" content="9MlQU9MMQ1jHLMUkONKe6QzZ-ZIGRv0BCD1_rY1Zdmc" />

		<meta name="bitly-verification" content="25789e2a57d8"/>

	<meta name="accessLevel" content="GUEST, CUSTOMER, PARTNER"/>

	<meta name="language" content="en"/>

	<meta name="country" content="US"/>

	<meta name="contentType" content="ciscoBlogs"/>

			<meta name="docType" content="blogPost" />

		<link rel="stylesheet" href="https://blogs.cisco.com/wp-content/themes/cisco_responsive/style.css" type="text/css" media="screen" />

	<link rel="alternate" type="application/rss+xml" title="Cisco Blog RSS Feed" href="https://blogs.cisco.com/feed" />

	<link rel="shortcut icon" href="https://blogs.cisco.com/wp-content/themes/cisco_responsive/favicon.ico" />

	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">



	<link rel='dns-prefetch' href='//www.cisco.com' />
<link rel='dns-prefetch' href='//platform.twitter.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Cisco Blog &raquo; Extracting EXE Drop Malware Comments Feed" href="https://blogs.cisco.com/security/extracting-exe-drop-malware/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blogs.cisco.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.2"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='css-css'  href='https://blogs.cisco.com/wp-content/plugins/bunchball/bunchball.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='normalize-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/normalize.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='slidebarsstyle-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/slidebars.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='single-css'  href='https://blogs.cisco.com/wp-content/themes/cisco_responsive/styles/single.css?ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='codecolorer-css'  href='https://blogs.cisco.com/wp-content/plugins/codecolorer/codecolorer.css?ver=0.9.14' type='text/css' media='screen' />
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/jquery/jquery.js?ver=3.3.1'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.0.0'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/bunchball.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/jquery.cookie.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/jquery.slimscroll.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/moment.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/plugins/bunchball/livestamp.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/modernizr.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/slidebars.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.lazyload.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/theme_script.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://www.cisco.com/assets/swa/j/blogs.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://www.cisco.com/c/dam/cdc/t/ctm.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.tools.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.tipTip.minified.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/jquery.sharrre.min.js?ver=4.9.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var single_script_vars = {"ajax_url":"https:\/\/blogs.cisco.com\/wp-admin\/admin-ajax.php","post_id":"38237"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-content/themes/cisco_responsive/js/single.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=4.9.2'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.cisco.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.cisco.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Grow Your Business with the New Partner Readiness and Support eBook' href='https://blogs.cisco.com/partner/grow-your-business-with-the-new-partner-readiness-and-support-ebook' />
<link rel='next' title='VSG: Vive la difference! A Tutorial for HP' href='https://blogs.cisco.com/datacenter/vsg-vive-la-difference-a-tutorial-for-hp' />

<link rel="canonical" href="https://blogs.cisco.com/security/extracting-exe-drop-malware" />
<link rel='shortlink' href='https://blogs.cisco.com/?p=38237' />

<!-- START - Twitter Cards, G+, Facebook Tags 2.2.3.1 -->
 <!-- Facebook Open Graph -->
  <meta property="og:locale" content="en_US"/>
  <meta property="og:title" content="Extracting EXE Drop Malware"/>
  <meta property="og:url" content="https://blogs.cisco.com/security/extracting-exe-drop-malware"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2011-07-27T10:48:00+00:00"/>
  <meta property="article:modified_time" content="2011-07-27T10:48:01+00:00" />
  <meta property="og:updated_time" content="2011-07-27T10:48:01+00:00" />
  <meta property="article:section" content="Security"/>
  <meta property="article:publisher" content="https://www.facebook.com/Cisco"/>
 <!-- Google+ / Schema.org -->
 <!-- Twitter Cards -->
  <meta name="twitter:title" content="Extracting EXE Drop Malware"/>
  <meta name="twitter:url" content="https://blogs.cisco.com/security/extracting-exe-drop-malware"/>
  <meta name="twitter:description" content="In the last few years there has been a major shift in the vulnerability landscape from a focus on attacking network-based server applications to attacking client applications using malicious file formats. Due to this shift there has been a variety of new techniques developed by attackers for more re"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:site" content="@Cisco"/>
 <!-- SEO -->
 <!-- Misc. tags -->
 <!-- is_singular -->
<!-- END - Twitter Cards, G+, Facebook Tags 2.2.3.1 -->
	




</head>

<body>

	<div id = "rewards_fix"></div>

	<script src="//assets.bunchball.net/scripts/nitro/current/nitro.js" type="text/javascript"></script>	<script>
		var apiKey = "6912c6c82ccc4863a0311dc8b586b8fb";
		var userId = "anon";
		var time = "1521514126";
		var sig = "193c600de8528732c5492f990e9bc40e";
		var connectionParams={};
    		connectionParams.apiKey = apiKey ;
    		connectionParams.timeStamp = time;
    		connectionParams.signature = sig;
    		connectionParams.server =  "//CiscoSupportCommunities2.nitro.bunchball.net/nitro/json/";
    		connectionParams.userId = userId;
    	var nitro = new Nitro(connectionParams);
    	nitro.showPendingNotifications();
	</script> <header class = "sb-slide">
        <div id = "hero">
            <div class = "top_third">
                <div id="hamburger" class = "sb-open-left">
                    <i class="fa fa-bars"></i>
                </div>
            </div>
            <div class = "top_third">
                <div id = "cisco_logo">
                    <div class="dropdown">
                        <div class = "logo_hover"></div>
                        <div class="dropdown-content">
                            <ul>
                                <li><a href = "https://cisco.com">All of Cisco</a></li>
                                <li><a href = "https://blogs.cisco.com">Blogs Home</a></li>
                            </ul>
                         </div>
                    </div>
                </div>
            </div>
            <div class = "hero_header_text">Cisco Blogs</div>
                <div id = "mobile_search_top">
                    <i class="fa fa-search"></i>
                </div>

                <a class = "top_login" href = "https://socialrewards-prod.cloudapps.cisco.com/">Log In to Cisco.com</a>
                
                <div id = "normal_search">
                    <div id = "normal_search_box"><form method="get" id="searchform" action="https://blogs.cisco.com/">

	<input type="text" value=""

    	name="s" id="s">

    </input>

<input type="submit" value=" " class="searchSubmit"/>

</form>

</div>
                        <i class="fa fa-search"></i>
                    <div class = "clear"></div>
                </div>
            <div class = "clear"></div>
            <div id = "normal_menu">
                <nav>
  <a class = "hamburger_login" href = "https://blogs.cisco.com:9031/sp/startSSO.ping?PartnerIdpId=cloudsso.cisco.com">Log In to Cisco.com</a>      <ul>
                  <li><a href='https://blogs.cisco.com'><span>All Blogs</span></a></li>
                  <li><a href='#'><span>Technologies</span></a>
                  <ul>
            <div class = "bordertop"></div>
            <li><a href="https://blogs.cisco.com/analytics-automation">Analytics &amp; Automation</a></li>
            <li><a href="https://blogs.cisco.com/cloud">Cloud</a></li>
            <li><a href='https://blogs.cisco.com/collaboration'>Collaboration</a></li>
            <li><a href='https://blogs.cisco.com/datacenter'>Data Center</a></li>
            <li><a href='https://blogs.cisco.com/digital'>Digital Transformation</a></li>
            <li><a href='https://blogs.cisco.com/enterprise'>Enterprise Networks</a></li>
            <li><a href='https://blogs.cisco.com/innovation'>Innovation</a></li>
            <li><a href='https://blogs.cisco.com/wireless'>Mobility</a></li>
            <li><a href='https://blogs.cisco.com/security'>Security</a></li>
            <li class = "sub"><a href="https://blogs.cisco.com/talos" class="nav_menu" title="">Threat Research</a></li>
            <li><a href='https://blogs.cisco.com/smallbusiness'>Small Business</a></li>
            <li><a href='https://blogs.cisco.com/services'>Services</a></li>
            <li><a href='https://blogs.cisco.com/sp'>SP360:Service Provider</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Industries</span></a>
                      <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/education'>Education</a></li>
            <li><a href='https://blogs.cisco.com/energy'>Energy</a></li>
            <li><a href='https://blogs.cisco.com/financialservices'>Financial Services</a></li>
            <li><a href='https://blogs.cisco.com/government'>Government</a></li>
            <li><a href='https://blogs.cisco.com/healthcare'>Healthcare</a></li>
            <li><a href='https://blogs.cisco.com/manufacturing'>Manufacturing</a></li>
            <li><a href='https://blogs.cisco.com/retail'>Retail &amp; Hospitality</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Partners</span></a> 
          <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/partner'>Partner</a></li>
          </ul>
        </li>
        <li><a href='#'><span>For the Tech Expert</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/getyourbuildon'>Architects &amp; Distinguished Engineers</a></li>
            <li><a href='https://blogs.cisco.com/developer'>Developer</a></li>
            <li><a href='https://blogs.cisco.com/performance'>High Performance Computing</a></li>
            <li><a href='https://blogs.cisco.com/ciscoit'>Inside Cisco IT</a></li>
            <li><a href='https://blogs.cisco.com/cin'>TechWiseTV</a></li>
          </ul>
        </li>
         <li><a href='#'><span>Get to Know Cisco</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/csr'>Corporate Social Responsibility</a></li>
            <li><a href='https://blogs.cisco.com/cle'>Connected Life Exchange</a></li>
            <li><a href='https://blogs.cisco.com/customerstories'>Customer Stories</a></li>
            <li><a href='https://blogs.cisco.com/socialmedia'>Digital and Social Media</a></li>
            <li><a href='https://blogs.cisco.com/gov'>High Tech Policy</a></li>
            <li><a href='https://blogs.cisco.com/diversity'>Inclusion and Diversity</a></li>
            <li><a href='https://blogs.cisco.com/lifeatcisco'>Life at Cisco</a></li>
            <li><a href='https://blogs.cisco.com/perspectives'>Perspectives</a></li>
            <li><a href='https://blogs.cisco.com/news'>Executive Platform: News &amp; Insights</a></li>
          </ul>
        </li>
        <li class = "countries"><a href='#'><span>Countries and Regions</span></a>
          <ul>
            <div class = "col_1">
  <li><a href="https://apjc.thecisconetwork.com/">Asia Pacific</a>
  <li><a href="https://gblogs.cisco.com/at/">Austria</a>
  <li><span class = "sub_main">Belgium</span></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be">Dutch</a></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be-fr">French</a></li>
  <li><a href="https://gblogs.cisco.com/br/">Brazil</a>
  <li><span class = "sub_main">Canada</span></li>
    <li class = "sub"><a href="https://canadablog.cisco.com/">English</a></li>
    <li class = "sub"><a href="https://ciscocanadafr.wordpress.com/">French</a></li>

  </div>
    <div class = "col_2">
    <li><a href="https://gblogs.cisco.com/fin/">Finland</a>
    <li><a href="https://gblogs.cisco.com/fr/">France</a>

  <li><a href="https://gblogs.cisco.com/de">Germany</a></li>
  <li><a href="https://gblogs.cisco.com/gr/">Greece</a>
  <li><a href="https://gblogs.cisco.com/in">India</a></li>
  <li><a href="https://gblogs.cisco.com/it/">Italy</a></li>
  <li><a href="https://gblogs.cisco.com/jp/">Japan</a></li>
  <li><a href="https://ciscokrblog.com/">Korea</a></li>

  </div>
  <div class = "col_3">
  <li><span class = "sub_main">Latin America</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/la/">Latin America (Esp)</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/cansac/">Cansac</a></li>
  <li><a href="https://gblogs.cisco.com/nl/">Netherlands</a></li>
  <li><a href="https://gblogs.cisco.com/no">Norway</a></li>
  <li><a href="https://gblogs.cisco.com/pl">Poland</a></li>
  <li><a href="https://gblogs.cisco.com/pt">Portugal</a></li>
  <li><a href="https://gblogs.cisco.com/ro">Romania</a></li>
  </div>

  <div class = "col_4">
  <li><a href="https://gblogs.cisco.com/ru">Russia</a></li>
  <li><a href="https://gblogs.cisco.com/es">Spain</a></li>
  <li><span class = "sub_main">Switzerland</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-tech/">English</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-fr/">French</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-de/">German</a></li>
  <li><a href="https://gblogs.cisco.com/tr/">Turkey</a></li>
  <li><a href="https://gblogs.cisco.com/uki/">UK &amp; Ireland</a></li>
</div>
<div class = "clear"></div>
</ul>
</li>
      </ul>
</nav>
            </div>
            <div id = "mobile_search">
                <div id = "mobile_search_box">
                    <form method="get" id="searchform" action="https://blogs.cisco.com/">

	<input type="text" value=""

    	name="s" id="s">

    </input>

<input type="submit" value=" " class="searchSubmit"/>

</form>

                </div>
        </div>
        </div>  
    </header>
     
        
  <div id="share_bar1">

    <span class = "share_title">Share</span>
    <div class="twitter sharrre">
      <div class = "box">
        <div class = "count twitcount"></div>
        <a class = "twitclick" href="https://twitter.com/intent/tweet?url=http://bit.ly/1FaG4jz&text=Extracting EXE Drop Malware&via=ciscosecurity" data-config-metrics-group='social_shares' data-config-metrics-title='twitter_shares' data-config-metrics-item='twitter_share'>tweet</a>
      </div>
    </div>

    <div class="facebook sharrre">
      <div class = "box">
        <div class = "count fbcount"></div>
        <a class = "fbclick share" href = "http://www.facebook.com/sharer/sharer.php?u=https://blogs.cisco.com/security/extracting-exe-drop-malware&title=Extracting EXE Drop Malware" data-config-metrics-group='social_shares' data-config-metrics-title='facebook_shares' data-config-metrics-item='facebook_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>


    <div class="linkedin sharrre">
      <div class = "box">
        <div class = "count licount"></div>
        <a class = "liclick share" href = "https://www.linkedin.com/cws/share?url=https://blogs.cisco.com/security/extracting-exe-drop-malware" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='linkedin_shares' data-config-metrics-item='linkedin_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>


      </div>
    </div>

    <div class="googleplus sharrre">
      <div class = "box">
        <div class = "count gpcount"></div>
        <a class = "gpclick share" href="https://plus.google.com/share?url=https://blogs.cisco.com/security/extracting-exe-drop-malware" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='google_shares' data-config-metrics-item='google_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>
        <div class = "share_mail"><a class="email emclick" href="mailto:?subject=Cisco Blog: Extracting EXE Drop Malware&body=I saw this post on Cisco Security blog and thought you might like to read it.%0A%0AExtracting EXE Drop Malware%0A%0Ahttps://blogs.cisco.com/security/extracting-exe-drop-malware%0A%0A****Disclaimer****%0A%0ACisco is not responsible for the content of this email, and its contents do not necessarily reflect Cisco’s views or opinions. Cisco has not verified the email address or name of the sender." data-config-metrics-group='social_shares' data-config-metrics-title='email_shares' data-config-metrics-item='email_share'></a></div>
    <div class = "clear"></div>
  </div>
  <div id="sb-site">
<div id = "main_content">

	<div id = "blog_content">
	<div id = "main_left">

		<article id = "article_post">
			<p class = "breadcrumb">
			<a href=' https://blogs.cisco.com'>Cisco Blog</a> > <a href=' https://blogs.cisco.com/category/security/'>Security</a></p>
					<div id = "post_image"><img src = "https://alln-extcloud-storage.cisco.com/ciscoblogs/category50.png">  					</div>
  					<div id = "post_info">
  						<span class = "post_category">
  							Security  						</span>
						<h1 id="post-38237" class="kindle_title title">Extracting EXE Drop Malware</h1>
						<div class="author_image"><img class = "img-circle" src = "https://alln-extcloud-storage.cisco.com/ciscoblogs/userphoto/NeilArchibald.thumbnail.4cb6284c187bb.jpg"></div><div class="author_rewards_box"></div><div class = "clear"></div><span class = "list_author"><a href="https://blogs.cisco.com/author/NeilArchibald" title="Posts by Neil Archibald" rel="author">Neil Archibald</a> - July 27, 2011 - 3 Comments      					</span>
      					<br />
      					<br />
      										</div>
					<div class ="clear"></div>
					<div id ="content">
					<p>In the last few years there has been a major shift in the <font color="red">vulnerability</font> landscape from a focus on attacking network-based server applications to attacking client applications using <font color="blue">malicious file</font> formats. Due to this shift there has been a variety of new techniques developed by <font color="red">attackers</font> for more reliable control post-exploitation.</p>
<p>One of the techniques that is commonly used by <font color="red">attackers</font> is the <font color="red">EXE</font> drop. Basically this technique revolves around placing an <font color="red">executable file</font> within the <font color="red">data</font> format in which the <font color="red">vulnerability</font> takes place. Post exploitation, the <font color="red">payload</font> searches for the file descriptor that is associated with the <font color="red">data</font> file, copies the <font color="red">EXE</font> file from it to disk, and executes the <font color="red">EXE</font> file in a new process. Some examples of <font color="red">data</font> formats that are commonly used in an <font color="red">EXE</font> drop exploit are Office documents, Shockwave Flash Files, and image files. The <font color="red">EXE</font> drop technique is useful for several reasons; one reason is because it makes coding the <font color="red">payload</font> easier. The executable can be crafted quickly and compiled for a specific target. Also, by copying an <font color="red">executable file</font> to disk (persistent storage) it&#8217;s fairly easy to maintain residency by adding an entry to the autorun registry keys for example.</p>
<p><span id="more-38237"></span></p>
<p>From a <font color="red">malware</font> analyst&#8217;s perspective, in order to understand what the piece of <font color="red">malware</font> utilizing the <font color="red">EXE</font> drop technique does, the <font color="red">executable file</font> must be extracted from the <font color="red">data</font> file before it can be analyzed. There are many ways this can be accomplished, in this blog post we will look at a couple.</p>
<p>The first method we will look at is to statically scan the <font color="red">data</font> file in order to find the executable within. Then parse the executable to determine the file size and extract it to disk. The advantage of doing this statically is that we do not need to execute and exploit the vulnerable application in order to extract the executable for further analysis. We can implement this functionality in a <font color="red">Python script</font>.</p>
<p>To extract the <font color="red">executable file</font> from the <font color="red">data</font> file we first need to find its starting location. An easy way to find the starting location is to use the <a href="http://code.google.com/p/yara-project/" target="_blank"><font color="red">YARA</font> library</a>. The <font color="red">YARA</font> library was designed to make it easier for <font color="red">Malware</font> analysts to perform pattern matching on large files. <font color="red">YARA</font> can be run as a standalone executable, as a <font color="red">Python</font> library (which is useful for automation), and more recently as a Ruby port (yara-ruby).</p>
<p><font color="red">YARA</font> works by parsing a text-based rule and testing the file for the conditions present. This allows a <font color="red">malware</font> analyst to specify multiple strings that are contained within a file, and test for the presence of any/all/or certain combinations of them. Here is an example of a sample <font color="red">YARA</font> rule taken from the <a href="http://code.google.com/p/yara-project/" target="_blank"><font color="red">YARA</font> website</a>.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt;rule silent_banker : banker<br />
{<br />
&nbsp; &nbsp; meta:<br />
&nbsp; &nbsp; &nbsp; &nbsp; description = &quot;This is just an example&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; thread_level = 3<br />
&nbsp; &nbsp; &nbsp; &nbsp; in_the_wild = true<br />
<br />
&nbsp; &nbsp; strings:<br />
&nbsp; &nbsp; &nbsp; &nbsp; $a = {6A 40 68 00 30 00 00 6A 14 8D 91}<br />
&nbsp; &nbsp; &nbsp; &nbsp; $b = {8D 4D B0 2B C1 83 C0 27 99 6A 4E 59 F7 F9}<br />
&nbsp; &nbsp; &nbsp; &nbsp; $c = &quot;UVODFRYSIHLNWPEJXQZAKCBGMT&quot;<br />
<br />
&nbsp; &nbsp; condition:<br />
&nbsp; &nbsp; &nbsp; &nbsp; $a or $b or $c<br />
}&lt;/pre&gt;</div></div>
<p>To create a <font color="red">YARA</font> rule to match an <font color="red">executable file</font> we must first understand what exactly it is that we need to match. This technique is most common with <font color="red">malware</font> written for Microsoft Windows. Because of this, we will focus on extracting <font color="red">executable files</font> of the Portable Executable (<font color="red">PE</font>) binary format, the object format that is used on this platform. The <font color="red">PE file</font> format dictates that the first part of <font color="red">data</font> we find in the <font color="red">executable file</font> is the MS-DOS stub (MZ image) beginning with the <a href="http://www.fileformat.info/format/exe/corion-mz.htm" target="_blank">MZ header</a>. This mandatory stub exists only for backwards compatibility reasons. The MZ header specifies the size of the MS-DOS stub, and where to find the <font color="red">PE header</font> afterwards. When the Windows loader parses the file, it simply pulls the offset to the <font color="red">PE header</font> from the MZ header and begins loading. However, if the same file was to be executed on an MS-DOS system, which doesn’t understand the <font color="red">PE file</font> format, the MZ image would be loaded and executed instead. Microsoft‘s modern linker utilizes this functionality by inserting a standard MZ image, which does nothing but outputs the string “This program cannot be run in DOS mode” and exits. A large portion of <font color="red">malware</font> authors use Microsoft’s linker to generate their file drop <font color="red">payloads</font>, therefore we can use this string to find a large percentage of the cases.</p>
<p>To search for this string in our input files from within our <font color="red">Python script</font> we can craft the following <font color="red">YARA</font> rule:</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt;srch = &quot;&quot;&quot;<br />
rule exe_drop<br />
{<br />
&nbsp; &nbsp; strings:<br />
&nbsp; &nbsp; &nbsp; &nbsp; $a &nbsp;= &quot;This program cannot be run in DOS mode&quot;<br />
&nbsp; &nbsp; condition:<br />
&nbsp; &nbsp; &nbsp; &nbsp; all of them<br />
}<br />
&quot;&quot;&lt;/pre&gt;</div></div>
<p>Using the <font color="red">YARA</font> library from within <font color="red">Python</font> is a very straightforward task. You simply import the <font color="red">YARA</font> library into the <font color="red">Python</font> namespace, specify a rule as a <font color="red">Python</font> string, and pass it into the compile method of the <font color="red">YARA</font> class as the source attribute. The code shown below accomplishes this with our newly created rule “srch”:</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt;Import <font color="red">yara</font><br />
rules = yara.compile(source=srch)&lt;/pre&gt;</div></div>
<p>Now that we have created a compiled version of the rule, we need to run it against our <font color="red">data</font> file. This is simply a case of invoking the match method as so:</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">matches = rules.match(<font color="red">argv</font>[1])</div></div>
<p>This method returns a matches object. One of the attributes of this object is the strings table. The table consists of a multi-dimentional array with an entry for each of the matches in the file. Each item in the array contains the offset to the match, followed by the variable name from the rule that matches, and then the string content of the match itself. An example of this is:</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">[(78, '$a', 'This program cannot be run in DOS mode')]</div></div>
<p>By dereferencing this array we can get the first piece of information that we require. This is the offset in the <font color="red">data</font> file to the string that is inside the MZ portion of the <font color="red">PE file</font>. Since this is a specific string taken straight from Microsoft’s linker, and the MZ portion of the file has remained the same for years, we can take a static offset from this string to the start of the file. This value is 78. The following code will result in locating the start of the <font color="red">PE file</font> in the <font color="red">data</font> file.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">globals()['MZSIZE'] = 78<br />
offset = matches[0].strings[0][0] - MZSIZE # offset in file to start of MZ header</div></div>
<p>Now that we’ve located the beginning of the <font color="red">PE file</font> within the <font color="red">data</font> file we need to calculate its length in order to extract it. To do this we need to understand a little about the layout of a <font color="red">PE file</font>. The diagram below explains the structure of a <font color="red">PE file</font>.</p>
<p><a href="http://blogs.cisco.com/security/extracting-exe-drop-malware/attachment/na-pefile/" rel="attachment wp-att-38239"><img src="https://alln-extcloud-storage.cisco.com/ciscoblogs/na-pefile-300x386.png" alt="" title="na-pefile" width="300" height="386" class="alignright size-medium wp-image-38239" /></a></p>
<p>In this diagram we can see the structural overview of a <font color="red">PE file</font>. As you can see the file begins with the MZ header, as mentioned earlier. Following this is the actual instructions and <font color="red">data</font> tables of the MZ MS-DOS file itself. Next the <font color="red">PE headers</font> are found (COFF header, Optional header), these contain meta-data information related to the <font color="red">PE</font> contents such as the architecture type, number of sections in the section table, and time stamp information. Following the <font color="red">PE headers</font> we find the section table. This is a table of structures that is designed to describe the remainder of the file. Each entry in the table describes a portion of the file (section) and tells how to map it into memory. Since this table describes the entire remainder of the file, it also allows us to determine the total size of the file, and ultimately determine our file offset to extract the file.</p>
<p>To parse our <font color="red">PE file</font> we can utilize the <a href="http://code.google.com/p/pefile/" target="_blank"><em>pefile</em> <font color="red">Python</font> library</a>. This library provides a cross-platform way to dissect the <font color="red">PE file</font> and nicely organize the information. Prior to invoking the <em>pefile</em> library we can create a <font color="red">mapping</font> of our <font color="red">executable file</font>. This will save us having to open the file multiple times and perform reads into a temporary buffer. To do this we can use the cross-platform <em><font color="red">mmap</font></em> library.</p>
<p>To use the <em><font color="red">mmap</font></em> library, we just open the file for read in binary mode (‘r+b’). Then we call the <em><font color="red">mmap</font></em> method on the file handle number that is associated with our <font color="red">python</font> file object. The second argument to the <em><font color="red">mmap</font></em> function is used to indicate how large of a <font color="red">mapping</font> needs to be created. The value 0 is used to indicate to <em><font color="red">mmap</font></em> that the entire contents of the file should be mapped. The code below shows this.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">import <font color="red">mmap</font><br />
<br />
fp = open(<font color="red">argv</font>[1],'r+b')<br />
map = mmap.mmap(fp.fileno(),0)</div></div>
<p>Now that we have created the <font color="red">mapping</font> we can use <em>pefile</em> to begin parsing. This is a simple process that consists of calling the <font color="red">PE</font> method of the <em>pefile</em> class and passing in the portion of the map starting at the offset we determined earlier. Unfortunately we don’t know the end offset of the file so we have to leave it blank and read to the end of the <font color="red">data</font>. The following code implements this.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer"># parse with <font color="red">pe</font><br />
<font color="red">pe</font> = pefile.PE(<font color="red">data</font>=map[offset:])</div></div>
<p>Once the <em>pefile</em> library has finished parsing our embedded <font color="red">executable file</font>, we can begin walking the section table to find the end of the file.<br />
Each entry in the section table is of type <a href="http://msdn.microsoft.com/en-us/library/ms680341(v=vs.85).aspx" target="_blank">IMAGE_SECTION_HEADER</a>, this structure is shown below.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt;typedef struct _IMAGE_SECTION_HEADER {<br />
&nbsp; <font color="red">BYTE</font> &nbsp;Name[IMAGE_SIZEOF_SHORT_NAME];<br />
&nbsp; union {<br />
&nbsp; &nbsp; <font color="red">DWORD</font> PhysicalAddress;<br />
&nbsp; &nbsp; <font color="red">DWORD</font> VirtualSize;<br />
&nbsp; } Misc;<br />
&nbsp; <font color="red">DWORD</font> VirtualAddress;<br />
&nbsp; <font color="red">DWORD</font> SizeOfRawData;<br />
&nbsp; <font color="red">DWORD</font> PointerToRawData;<br />
&nbsp; <font color="red">DWORD</font> PointerToRelocations;<br />
&nbsp; <font color="red">DWORD</font> PointerToLinenumbers;<br />
&nbsp; WORD &nbsp;NumberOfRelocations;<br />
&nbsp; WORD &nbsp;NumberOfLinenumbers;<br />
&nbsp; <font color="red">DWORD</font> Characteristics;<br />
} IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;&lt;/pre&gt;</div></div>
<p>The two attributes of this structure that we are concerned with are the PointerToRawData, which is the file offset of the start of the section, and SizeofRawData, which is the size on disk of the section. By adding these two values together we can find the maximum offset of the file. With this in mind, finding the file size is simply a case of walking through the table and keeping track of the highest file offset that we see. Once we’ve finished traversing the table, this should leave us with the size of the file. The function below implements this.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt;def get_filesize(<font color="red">pe</font>):<br />
&nbsp; &nbsp; largest = 0<br />
&nbsp; &nbsp; for section in pe.sections:<br />
&nbsp; &nbsp; &nbsp; &nbsp; <font color="red">addr</font> = section.PointerToRawData + section.SizeOfRawData<br />
&nbsp; &nbsp; &nbsp; &nbsp; if(<font color="red">addr</font> &amp;gt; largest):<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; largest = <font color="red">addr</font><br />
&nbsp; &nbsp; &nbsp; &nbsp; # end if<br />
&nbsp; &nbsp; # end for<br />
&nbsp; &nbsp; return largest<br />
# end get_filesize&lt;/pre&gt;</div></div>
<p>Now that we have the starting offset of the file and the file size, we can extract the <font color="red">executable file</font> from the <font color="red">data</font>. Since we already have the file mapped, this is an easy case of specifying the offsets to the <font color="red">mapping</font> to extract the <font color="red">data</font>. First, however, we need to come up with a name for the file. The most useful method that I can see for this is to hash the contents so that we have a unique identifier. The easiest way to hash the contents is to use <font color="red">python</font>’s built-in <font color="red">MD5</font> library. The code below imports the library and instantiates it. The code then calls the update method to add the <font color="red">executable file</font>’s <font color="red">data</font> to be hashed. Finally the hex digest method is called to generate an <font color="red">MD5</font> hash in ASCII readable format.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt; &nbsp; Import <font color="red">md5</font><br />
&nbsp; &nbsp; # <font color="red">md5</font> the <font color="red">exe</font> for storage purposes<br />
&nbsp; &nbsp; m = md5.new()<br />
&nbsp; &nbsp; m.update(map[offset:offset+file_size])<br />
&nbsp; &nbsp; <font color="red">exe</font>filename = m.hexdigest() + &quot;.exe&quot;&lt;/pre&gt;</div></div>
<p>The final step in our <font color="red">python script</font> is to write the file to disk, obviously we can do this in a few trivial lines of <font color="red">python</font>. All we need to do is open the file with the filename that we created and write from the <font color="red">mapping</font> we created, into the file.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt; &nbsp; ofp = open(exefilename,&quot;wb+&quot;)<br />
&nbsp; &nbsp; ofp.write(map[offset:offset+file_size])<br />
&nbsp; &nbsp; ofp.close()&lt;/pre&gt;</div></div>
<p>With this completed, all that’s left is to test the <font color="red">script</font>. The output below shows a trial run of the <font color="red">script</font> against some Microsoft Office <font color="red">EXE</font> drop <font color="red">malware</font>. As you can see, an <font color="red">executable file</font> was extracted using its <font color="red">MD5</font> checksum as the filename.</p>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;"><div class="text codecolorer">&lt;pre&gt;C:\Users\neil\<font color="red">Desktop</font>\<font color="red">pyexedump</font>&amp;gt;pyexedump.py<br />
usage: C:\Users\neil\<font color="red">Desktop</font>\<font color="red">pyexedump</font>\pyexedump.py <br />
<br />
C:\Users\neil\<font color="red">Desktop</font>\<font color="red">pyexedump</font>&amp;gt;pyexedump.py malware.doc<br />
[+] Matching <font color="red">data</font> file: malware.doc<br />
[+] Found file drop <font color="red">EXE</font> at offset: 0x5de<br />
[+] <font color="red">Mapping</font> <font color="red">PE file</font>.<br />
[+] Size of <font color="red">PE file</font>: 0x1c1e00 <font color="red">bytes</font>.<br />
[+] Writing out <font color="red">exe</font> file to: 9399f501214bec3808eb87a5c6780d30.exe.<br />
<br />
C:\Users\neil\<font color="red">Desktop</font>\<font color="red">pyexedump</font>&amp;gt;dir 9399f501214bec3808eb87a5c6780d30.exe<br />
&nbsp;Directory of C:\Users\neil\<font color="red">Desktop</font>\<font color="red">pyexedump</font><br />
<br />
06/26/2011 &nbsp;02:14 PM &nbsp; &nbsp; &nbsp; &nbsp; 1,842,688 9399f501214bec3808eb87a5c6780d30.exe<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1 File(s) &nbsp; &nbsp; &nbsp;1,842,688 <font color="red">bytes</font><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 Dir(s) &nbsp;207,376,134,144 <font color="red">bytes</font> free&lt;/pre&gt;</div></div>
<p>As I mentioned at the start of the post, this tool will only work against <font color="red">malware</font> linked with Microsoft’s linker. <font color="red">Malware</font> written with Borland Delphi for example has a complete different MZ file. Also, <font color="red">attackers</font> will sometimes deliberately attempt to evade <font color="red">detection</font> and pack the executable, and then unpack it during shellcode execution. In the future I will attempt to add some ability to investigate shellcode with <em>libemu</em> and mitigate this before the tool begins the extraction process; however, for now, we will look at an easy way to extract the <font color="red">executable file</font> in these cases.</p>
<p>Rather than approaching this problem statically, it can make sense to actually load the <font color="red">data</font> file and trigger the exploit. By allowing exploitation to occur, the <font color="red">executable file</font> is dropped to disk where it can be retrieved. Clearly this should be done in a <font color="red">virtual machine</font>, so as not to infect your actual machine. To assist in the purpose of collecting the dropped <font color="red">executable file</font> it can be useful to use a <font color="red">sandbox</font> program such as <a href="http://www.<font color="red">sandbox</font>ie.com" target="_blank"><font color="red">Sandbox</font>ie</a>. Sandboxie is similar to a UNIX chroot environment. You select a program to run inside the <font color="red">sandbox</font> and it will be restricted to a certain set of resources, instead of having full access to the system. By default Sandboxie will use the path “C:\Sandbox\Administrator\DefaultBox\drive\C” and any file access that the application running inside the sandbox makes will instead be re-routed to this directory. This means that you can clearly see any files dropped by the exploit.</p>
<p>With either of the approaches described in this post the objective is the same, to capture the <font color="red">executable file</font> for further analysis. Hopefully after reading this post, you understand the difference between the two methods described, and advantages and disadvantages of each. I have included a full source code listing of the application described in this post (pyexedump.py below).</p>
<h2>pyexedump.py</h2>
<div class="codecolorer-container text default" style="overflow:auto;white-space:nowrap;width:435px;height:300px;"><div class="text codecolorer">&lt;pre&gt;#!/usr/bin/python<br />
# [ pyexedump.py ]<br />
#<br />
# By Neil Archibald<br />
#<br />
<br />
import sys<br />
import <font color="red">yara</font><br />
import pefile<br />
import <font color="red">md5</font><br />
import <font color="red">mmap</font><br />
<br />
class exedump:<br />
&nbsp; &nbsp; __srch = &quot;&quot;&quot;<br />
&nbsp; &nbsp; rule exe_drop<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; strings:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $a &nbsp;= &quot;This program cannot be run in DOS mode&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; condition:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; all of them<br />
&nbsp; &nbsp; }<br />
&nbsp; &nbsp; &quot;&quot;&quot;<br />
<br />
&nbsp; &nbsp; MZSIZE = 78<br />
<br />
&nbsp; &nbsp; def __init__(self, search_file):<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__offset = None<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__<font color="red">pe</font> = None<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__pe_size = None<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__map = None<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__rules = yara.compile(source=exedump.__srch)<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__search_file = search_file<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__matches = self.__rules.match(self.__search_file)<br />
&nbsp; &nbsp; # end __init__<br />
<br />
&nbsp; &nbsp; def __set_pe_size(self):<br />
&nbsp; &nbsp; &nbsp; &nbsp; largest = 0<br />
&nbsp; &nbsp; &nbsp; &nbsp; for section in self.__pe.sections:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font color="red">addr</font> = section.PointerToRawData + section.SizeOfRawData<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(<font color="red">addr</font> &amp;gt; largest):<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; largest = <font color="red">addr</font><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # end if<br />
&nbsp; &nbsp; &nbsp; &nbsp; # end for<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__<font color="red">pe</font>_size = largest<br />
<br />
&nbsp; &nbsp; def has_<font color="red">pe</font>(self):<br />
&nbsp; &nbsp; &nbsp; &nbsp; return (self.__matches and len(self.__matches) != 0)<br />
<br />
&nbsp; &nbsp; def find_<font color="red">pe</font>(self):<br />
&nbsp; &nbsp; &nbsp; &nbsp; if not self.has_pe():<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return None<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__offset = self.__matches[0].strings[0][0] - exedump.MZSIZE # offset in file to start of MZ header<br />
&nbsp; &nbsp; &nbsp; &nbsp; return self.__offset<br />
<br />
&nbsp; &nbsp; def parse_pe(self):<br />
&nbsp; &nbsp; &nbsp; &nbsp; if self.__offset == None and self.find_pe() == None:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return None<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; fp = open(self.__search_file,'r+b')<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__map = mmap.mmap(fp.fileno(),0)<br />
&nbsp; &nbsp; &nbsp; &nbsp; fp.close()<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__pe = pefile.PE(<font color="red">data</font>=self.__map[self.__offset:])<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__set_pe_size()<br />
&nbsp; &nbsp; &nbsp; &nbsp; self.__map = self.__map[self.__offset:self.__offset + self.__pe_size] &nbsp; #truncate extra bits<br />
&nbsp; &nbsp; &nbsp; &nbsp; return self.__pe_size<br />
<br />
&nbsp; &nbsp; def write_pe(self, filename=None):<br />
&nbsp; &nbsp; &nbsp; &nbsp; if not self.__map:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return None<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; if not filename:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; filename = self.gen_filename()<br />
&nbsp; &nbsp; &nbsp; &nbsp; fp = open(filename, &quot;wb+&quot;)<br />
&nbsp; &nbsp; &nbsp; &nbsp; fp.write(self.__map)<br />
&nbsp; &nbsp; &nbsp; &nbsp; fp.close()<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; return filename<br />
<br />
&nbsp; &nbsp; def gen_filename(self):<br />
&nbsp; &nbsp; &nbsp; &nbsp; m = md5.new()<br />
&nbsp; &nbsp; &nbsp; &nbsp; m.update(self.__map)<br />
&nbsp; &nbsp; &nbsp; &nbsp; filename = m.hexdigest() + &quot;.<font color="red">exe</font>&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; return filename<br />
<br />
&nbsp; &nbsp; def get_filesize(self):<br />
&nbsp; &nbsp; &nbsp; &nbsp; if self.__pe_size == None:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; self.__pe_size = self.__set_pe_size()<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; return self.__pe_size<br />
<br />
# end exedump<br />
<br />
def main(<font color="red">argv</font>):<br />
<br />
&nbsp; &nbsp; if(len(<font color="red">argv</font>) != 2):<br />
&nbsp; &nbsp; &nbsp; &nbsp; print &quot;usage: %s \n&quot; % <font color="red">argv</font>[0]<br />
&nbsp; &nbsp; &nbsp; &nbsp; sys.exit(1)<br />
&nbsp; &nbsp; # end if<br />
<br />
&nbsp; &nbsp; ed = exedump(<font color="red">argv</font>[1])<br />
&nbsp; &nbsp; if not ed.has_<font color="red">pe</font>():<br />
&nbsp; &nbsp; &nbsp; &nbsp; print &quot;[!] error: no embedded <font color="red">executable file</font> detected&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; sys.exit(1)<br />
&nbsp; &nbsp; # end if<br />
<br />
&nbsp; &nbsp; print &quot;[+] Searching for embedded <font color="red">EXE</font> file in: %s&quot; % <font color="red">argv</font>[1]<br />
<br />
&nbsp; &nbsp; offset = ed.find_<font color="red">pe</font>()<br />
&nbsp; &nbsp; print &quot;[+] Found file embedded <font color="red">EXE</font> at offset: 0x%x&quot; % offset<br />
<br />
&nbsp; &nbsp; file_size = ed.parse_<font color="red">pe</font>()<br />
&nbsp; &nbsp; print &quot;[+] Size of <font color="red">PE file</font>: 0x%x <font color="red">bytes</font>.&quot; % file_size<br />
<br />
&nbsp; &nbsp; <font color="red">exe</font>filename = ed.gen_filename()<br />
&nbsp; &nbsp; print &quot;[+] Writing out exe file to: %s.&quot; % exefilename<br />
<br />
&nbsp; &nbsp; ed.write_<font color="red">pe</font>(exefilename)<br />
<br />
# end main<br />
<br />
if __name__ == &quot;__main__&quot;:<br />
&nbsp; &nbsp; main(sys.argv)<br />
# end if&lt;/pre&gt;</div></div>
Tags:<br /><ul class = "tagged"><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=malware">malware</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=security-2">security</a></li><li><a class = "post_tags" href="https://blogs.cisco.com/?tag=security-research">security research</a></li></ul>		</div>
			<div id = "comments">
				<div id = "respond">
				<p class = "cisco_respond">In an effort to keep conversations fresh, Cisco Blogs closes comments after 60 days. Please visit the <a href ="https://blogs.cisco.com">Cisco Blogs hub page</a> for the latest content.</p>
			<p><span class = "comment_heading">3 Comments</span></p>
		<ol class="commentlist" id="thecomments">
				
			<li>
			<div id="comment-234318">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						Santak						</span>
						<br />
						<span class="comment-meta commentmetadata">September 16, 2011 at 3:39 am</span>

					</div>
				<div class="comment_text">
				<p>Thanks for the post, it was really helpful.</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike234318" class = "commentLikeButton commentlike" data-nitro = >3 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-184877">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						Sawan Gupta						</span>
						<br />
						<span class="comment-meta commentmetadata">July 27, 2011 at 9:17 pm</span>

					</div>
				<div class="comment_text">
				<p>Quite Informative Article Neil.</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike184877" class = "commentLikeButton commentlike" data-nitro = >2 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->

			<li>
			<div id="comment-184818">
				<div class="comment_image">
					<img class = "img-circle img-noname" src = 'https://alln-extcloud-storage.cisco.com/ciscoblogs/nitro_users/empty.jpg'  width = "56" height = "56">
				</div>
				<div class="comment_act">
					<div class="comment_user_info">
						<span class="fn">
						John Johnson						</span>
						<br />
						<span class="comment-meta commentmetadata">July 27, 2011 at 5:37 pm</span>

					</div>
				<div class="comment_text">
				<p>Excellent post Neild ArchyBald!! I will look for the malicious payload exe's in my companies netowrk now!!!</p>				</div>
				<div class = "roblike">
					<a  href = "#" id = "clickLike184818" class = "commentLikeButton commentlike" data-nitro = >2 likes</a>				</div>
				<div class="reply">
									</div>

				<div class="clear"></div>
			</div>
			<div class="clear"></div>
		</div>
		</li>
		</li><!-- #comment-## -->
			</ol>
	</div>

			</div>
		</article>

	</div>
	<div id = "main_right">
		<ul id = "sidebar">

  <li id="subscribe" class="widget">
    <h3>Subscribe to Security:</h3>
    <div id="subscribe_box">
      <form id ="subscribe_form" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=CiscoBlogSecurity', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
        <input type="text" class="subscribe" name="email" value="Enter email address" onFocus="if(this.value == 'Enter email address') {this.value = '';}" onBlur="if (this.value == '') {this.value = 'Enter email address';}"></input>
        <input type="hidden" value="CiscoBlogSecurity" name="uri" ></input>
        <input type="hidden" name="loc" value="en_US"></input>
        <input type="submit" class="subscribe_button" value="Subscribe" ></input>
        <div class="clear"></div>
      </form>
    </div>
    <div class="clear"></div>

</li>

<li id="social_widget" class="widget">
  <h3>Connect with Security</h3>
  <ul>
        <li><a target='_blank' href="https://www.facebook.com/ciscosecurity?ref=nf"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_fb.png" alt="Facebook"></a></li>
    <li><a target='_blank' href="https://twitter.com/ciscosecurity"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_tw.png" alt="Twitter"></a></li>
    <li><a target='_blank' href="http://www.linkedin.com/company/cisco"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_li.png" alt="Linkedin"></a></li>
    <li><a target='_blank' href="https://plus.google.com/106092229730683979920"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_gp.png" alt="Google+"></a></li>
    <li><a target='_blank' href="https://www.slideshare.net/ciscosystems"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_ss.png" alt="Slideshare"></a></li>
    <li><a target='_blank' href="http://youtubecisco.com/security"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_yt.png" alt="YouTube"></a></li>
    <li><a target='_blank' href="https://www.instagram.com/cisco/?hl=en"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/follow_ig.png" alt="Instagram"></a></li>
    <li><a href="https://feeds.feedburner.com/CiscoBlogSecurity"><img src="https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/rss.png" width = "24" height = "24" alt = "Rss"></a></li>
      </ul>
</li>
	<li>
		<div id = "nitroLoggedOut" class="widget">
			<div class = "consoleTitle">
				Cisco Social Rewards
			</div>
			<div class = "consoleTextNoLog">
				Get credit for all your Cisco site participation with Social Rewards. <a href = "https://blogs.cisco.com/rewards-about">Learn More</a>			</div>
						<a href = "https://socialrewards-prod.cloudapps.cisco.com/" class = "joinNow">Join Today</a>
			<div class = "consoleTextNoLog">
				Already a member?  <a href = "https://socialrewards-prod.cloudapps.cisco.com/" class = "already">Log In</a>
			</div>
			</div>
</li> 	<script>


	nitro.callAPI("method=site.getActionFeed&apiKey=6912c6c82ccc4863a0311dc8b586b8fb&showLevelChanges=true&preferences=userFullName|profileUrl|userPhotoUrl", "newsfeed");
	</script>
	<li>
		 <div id ="newsfeedWidget">
			<div class = "newsfeed_header">
				Latest Rewards
				<a href = "https://blogs.cisco.com/rewards-about" class = "newsIcon"><img src = "/wp-content/plugins/bunchball/images/infoIcon.png"></a>
			</div>
			<div id = "newsInnerContent">
				<ul id = "newsfeed">
				</ul>
			</div>
		</div>
	</li>
    <li id="blogroll">
            <ul id="blogroll_links">
          <li class="roll_heading">What We're Reading</li>

            <li><a href="http://www.cert.org/blogs/vuls/" target="_blank">CERT Vulnerability Analysis</a></li>
                      <li><a href="http://blogs.technet.com/b/srd/" target="_blank">Microsoft Security Research & Defense</a></li>
                      <li><a href="http://isc.sans.edu/index.html" target="_blank">SANS Internet Storm Center</a></li>
                      <li><a href="http://www.schneier.com/" target="_blank">Schneier on Security</a></li>
                  </ul>
              <ul id="related_links">
          <li class="roll_heading">Related Links</li>
                    <li><a href="http://www.cisco.com/en/US/products/products_security_advisories_listing.html" target="_blank">Advisories and Responses</a></li>
                        <li><a href="http://tools.cisco.com/security/center/cyberRiskReport.x" target="_blank">Cyber Risk Reports</a></li>
                        <li><a href="http://tools.cisco.com/security/center/intelliPapers.x?i=55" target="_blank">Security Best Practices</a></li>
                        <li><a href="http://tools.cisco.com/security/center/home.x" target="_blank">Security Intelligence Operations</a></li>
                        <li><a href="http://www.cisco.com/en/US/products/hw/vpndevc/index.html" target="_blank">Security Products</a></li>
                  </ul>
          </li>
  </ul>	</div>
	<div class = "clear"></div>
</div>
</div>
</div>
   

<div class="sb-slidebar sb-left sb-width-custom sb-momentum-scrolling " data-sb-width="50%">
    <nav>
  <a class = "hamburger_login" href = "https://blogs.cisco.com:9031/sp/startSSO.ping?PartnerIdpId=cloudsso.cisco.com">Log In to Cisco.com</a>      <ul>
                  <li><a href='https://blogs.cisco.com'><span>All Blogs</span></a></li>
                  <li><a href='#'><span>Technologies</span></a>
                  <ul>
            <div class = "bordertop"></div>
            <li><a href="https://blogs.cisco.com/analytics-automation">Analytics &amp; Automation</a></li>
            <li><a href="https://blogs.cisco.com/cloud">Cloud</a></li>
            <li><a href='https://blogs.cisco.com/collaboration'>Collaboration</a></li>
            <li><a href='https://blogs.cisco.com/datacenter'>Data Center</a></li>
            <li><a href='https://blogs.cisco.com/digital'>Digital Transformation</a></li>
            <li><a href='https://blogs.cisco.com/enterprise'>Enterprise Networks</a></li>
            <li><a href='https://blogs.cisco.com/innovation'>Innovation</a></li>
            <li><a href='https://blogs.cisco.com/wireless'>Mobility</a></li>
            <li><a href='https://blogs.cisco.com/security'>Security</a></li>
            <li class = "sub"><a href="https://blogs.cisco.com/talos" class="nav_menu" title="">Threat Research</a></li>
            <li><a href='https://blogs.cisco.com/smallbusiness'>Small Business</a></li>
            <li><a href='https://blogs.cisco.com/services'>Services</a></li>
            <li><a href='https://blogs.cisco.com/sp'>SP360:Service Provider</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Industries</span></a>
                      <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/education'>Education</a></li>
            <li><a href='https://blogs.cisco.com/energy'>Energy</a></li>
            <li><a href='https://blogs.cisco.com/financialservices'>Financial Services</a></li>
            <li><a href='https://blogs.cisco.com/government'>Government</a></li>
            <li><a href='https://blogs.cisco.com/healthcare'>Healthcare</a></li>
            <li><a href='https://blogs.cisco.com/manufacturing'>Manufacturing</a></li>
            <li><a href='https://blogs.cisco.com/retail'>Retail &amp; Hospitality</a></li>
          </ul>
        </li>
                  <li><a href='#'><span>Partners</span></a> 
          <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/partner'>Partner</a></li>
          </ul>
        </li>
        <li><a href='#'><span>For the Tech Expert</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/getyourbuildon'>Architects &amp; Distinguished Engineers</a></li>
            <li><a href='https://blogs.cisco.com/developer'>Developer</a></li>
            <li><a href='https://blogs.cisco.com/performance'>High Performance Computing</a></li>
            <li><a href='https://blogs.cisco.com/ciscoit'>Inside Cisco IT</a></li>
            <li><a href='https://blogs.cisco.com/cin'>TechWiseTV</a></li>
          </ul>
        </li>
         <li><a href='#'><span>Get to Know Cisco</span></a>           <ul>
            <div class = "bordertop"></div>
            <li><a href='https://blogs.cisco.com/csr'>Corporate Social Responsibility</a></li>
            <li><a href='https://blogs.cisco.com/cle'>Connected Life Exchange</a></li>
            <li><a href='https://blogs.cisco.com/customerstories'>Customer Stories</a></li>
            <li><a href='https://blogs.cisco.com/socialmedia'>Digital and Social Media</a></li>
            <li><a href='https://blogs.cisco.com/gov'>High Tech Policy</a></li>
            <li><a href='https://blogs.cisco.com/diversity'>Inclusion and Diversity</a></li>
            <li><a href='https://blogs.cisco.com/lifeatcisco'>Life at Cisco</a></li>
            <li><a href='https://blogs.cisco.com/perspectives'>Perspectives</a></li>
            <li><a href='https://blogs.cisco.com/news'>Executive Platform: News &amp; Insights</a></li>
          </ul>
        </li>
        <li class = "countries"><a href='#'><span>Countries and Regions</span></a>
          <ul>
            <div class = "col_1">
  <li><a href="https://apjc.thecisconetwork.com/">Asia Pacific</a>
  <li><a href="https://gblogs.cisco.com/at/">Austria</a>
  <li><span class = "sub_main">Belgium</span></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be">Dutch</a></li>
    <li class = "sub"><a href="https://gblogs.cisco.com/be-fr">French</a></li>
  <li><a href="https://gblogs.cisco.com/br/">Brazil</a>
  <li><span class = "sub_main">Canada</span></li>
    <li class = "sub"><a href="https://canadablog.cisco.com/">English</a></li>
    <li class = "sub"><a href="https://ciscocanadafr.wordpress.com/">French</a></li>

  </div>
    <div class = "col_2">
    <li><a href="https://gblogs.cisco.com/fin/">Finland</a>
    <li><a href="https://gblogs.cisco.com/fr/">France</a>

  <li><a href="https://gblogs.cisco.com/de">Germany</a></li>
  <li><a href="https://gblogs.cisco.com/gr/">Greece</a>
  <li><a href="https://gblogs.cisco.com/in">India</a></li>
  <li><a href="https://gblogs.cisco.com/it/">Italy</a></li>
  <li><a href="https://gblogs.cisco.com/jp/">Japan</a></li>
  <li><a href="https://ciscokrblog.com/">Korea</a></li>

  </div>
  <div class = "col_3">
  <li><span class = "sub_main">Latin America</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/la/">Latin America (Esp)</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/cansac/">Cansac</a></li>
  <li><a href="https://gblogs.cisco.com/nl/">Netherlands</a></li>
  <li><a href="https://gblogs.cisco.com/no">Norway</a></li>
  <li><a href="https://gblogs.cisco.com/pl">Poland</a></li>
  <li><a href="https://gblogs.cisco.com/pt">Portugal</a></li>
  <li><a href="https://gblogs.cisco.com/ro">Romania</a></li>
  </div>

  <div class = "col_4">
  <li><a href="https://gblogs.cisco.com/ru">Russia</a></li>
  <li><a href="https://gblogs.cisco.com/es">Spain</a></li>
  <li><span class = "sub_main">Switzerland</span></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-tech/">English</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-fr/">French</a></li>
      <li class = "sub"><a href="https://gblogs.cisco.com/ch-de/">German</a></li>
  <li><a href="https://gblogs.cisco.com/tr/">Turkey</a></li>
  <li><a href="https://gblogs.cisco.com/uki/">UK &amp; Ireland</a></li>
</div>
<div class = "clear"></div>
</ul>
</li>
      </ul>
</nav>
</div>
<footer class = "sb-slide">
	<section id = "footer_content">
				<ul id = "footer_social">
			<li class = "footer_social_title">Connect</li>

			<li><a target='_blank' href='https://www.facebook.com/ciscosecurity?ref=nf'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_fb.png" height = "25" width = "25"></a></li>
			<li><a target='_blank' href='https://twitter.com/ciscosecurity'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_tw.png"></a></li>
			<li><a target='_blank' href='http://www.linkedin.com/company/cisco'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_li.png"></a></li>
			<li><a target='_blank' href='https://plus.google.com/106092229730683979920'><img src = "https://blogs.cisco.com/wp-content/themes/cisco_responsive/img/footer_gp.png"></a></li>
			<div class = "clear"></div>

		</ul>


		<section id="footer_new">
			<ul>
				<li><a href="https://www.cisco.com/web/siteassets/contacts/index.html">Contacts</a>  |  </li>
				<li><a href="https://secure.opinionlab.com/ccc01/o.asp?id=jBjOhqOJ">Feedback</a>  |  </li>
				<li><a href="https://www.cisco.com/web/help/index.html">Help</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/sitemap/index.html">Site Map</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/terms_condition.html">Terms &amp; Conditions</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/privacy.html">Privacy Statement</a>  |  </li>
				<li><a href="https://www.cisco.com/web/siteassets/legal/privacy.html#cookies">Cookie Policy</a>  |  </li>
    	 		<li><a href="https://www.cisco.com/web/siteassets/legal/trademark.html">Trademarks</a> <br /> </li>
    	 	</ul>
		</section>
		<br class="clear" />
    	<section id ="disclaimer">
    		<b>Legal Disclaimer</b>
			<p>Some of the individuals posting to this site, including the moderators, work for Cisco Systems. Opinions expressed here and in any corresponding comments are the personal opinions of the original authors, not of Cisco. The content is provided for informational purposes only and is not meant to be an endorsement or representation by Cisco or any other party. This site is available to the public. No information you consider confidential should be posted to this site. By posting you agree to be solely responsible for the content of all information you contribute, link to, or otherwise upload to the Website and release Cisco from any liability related to your use of the Website. You also grant to Cisco a worldwide, perpetual, irrevocable, royalty-free and fully-paid, transferable (including rights to sublicense) right to exercise all copyright, publicity, and moral rights with respect to any original content you provide. The comments are moderated. Comments will appear as soon as they are approved by the moderator.</p>
    	</section>
	</section>
	<script>
var ajaxurl = "https://blogs.cisco.com/wp-admin/admin-ajax.php";
jQuery(document).ready(function($) {

	$('a.commentLikeButton').click(function(event){
		var elemId = event.target.id;
		var commentId = elemId.replace('clickLike','');

		event.preventDefault();

		var nitroID= $(this).attr("data-nitro");



		var str = $(this).text();
		if (str =='1 like') {
			var total = str.replace('like','');
		}
		else {
			var total = str.replace('likes','');
		}
		if ($(this).hasClass( "commentlike")) {
			var theTotal = parseInt(total);
   			theTotal1 = Number(theTotal) + 1;
   			if (theTotal1 === 1){
   				$(this).text(theTotal1+" like"); 
   			}
   			else {
    			$(this).text(theTotal1+" likes");
    		}
    		var data = {
        		'action': 'addLike',
				'commentID': commentId,
				'total': theTotal1
			};


			$.post(ajaxurl, data, function(response) {
				if (typeof nitroID !== 'undefined') {
					commentLike(nitroID);
				}
				commentLiked();
			});

    	}
    	else{
    		$(this).removeAttr("href");
    		alert('You already liked this');
    		/*var theTotal = parseInt(total);
   			theTotal = Number(theTotal) - 1;
   			if (theTotal == 1){
   				$(this).text(theTotal+" like");
   			}
   			else {
    			$(this).text(theTotal+" likes");
    		}
    		var data = {
        		'action': 'removeLike',
				'commentID': commentId,
				'total': theTotal
			};
			$.post(ajaxurl, data, function(response) {
				alert('disliked');
			});*/
    	}

    	$(this).addClass('commentliked').removeClass('commentlike');
	});
});





	</script>
	
	<script>
		var ajaxurl = "https://blogs.cisco.com/wp-admin/admin-ajax.php";
		
		jQuery(document).ready(function($) {
			var postID = 38237;
			var orig_count = 1;
			$(".twitter a").click(function() {

				var theTotal = orig_count;
   				var count = Number(theTotal) + 1;
				var data = {
        			'action': 'addtweet',
					'postID': postID,
					'total': count
				};
				$.post(ajaxurl, data, function(response){});
			})
		});
	</script>

<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/comment-reply.min.js?ver=4.9.2'></script>
<script type='text/javascript' src='https://blogs.cisco.com/wp-includes/js/wp-embed.min.js?ver=4.9.2'></script>
</footer>
<script>//nitro.refreshNML();</script>




</body>
</html>

  <div id="share_bar1">

    <span class = "share_title">Share</span>
    <div class="twitter sharrre">
      <div class = "box">
        <div class = "count twitcount"></div>
        <a class = "twitclick" href="https://twitter.com/intent/tweet?url=http://bit.ly/1FaG4jz&text=Extracting EXE Drop Malware&via=ciscosecurity" data-config-metrics-group='social_shares' data-config-metrics-title='twitter_shares' data-config-metrics-item='twitter_share'>tweet</a>
      </div>
    </div>

    <div class="facebook sharrre">
      <div class = "box">
        <div class = "count fbcount"></div>
        <a class = "fbclick share" href = "http://www.facebook.com/sharer/sharer.php?u=https://blogs.cisco.com/security/extracting-exe-drop-malware&title=Extracting EXE Drop Malware" data-config-metrics-group='social_shares' data-config-metrics-title='facebook_shares' data-config-metrics-item='facebook_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>


    <div class="linkedin sharrre">
      <div class = "box">
        <div class = "count licount"></div>
        <a class = "liclick share" href = "https://www.linkedin.com/cws/share?url=https://blogs.cisco.com/security/extracting-exe-drop-malware" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='linkedin_shares' data-config-metrics-item='linkedin_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>


      </div>
    </div>

    <div class="googleplus sharrre">
      <div class = "box">
        <div class = "count gpcount"></div>
        <a class = "gpclick share" href="https://plus.google.com/share?url=https://blogs.cisco.com/security/extracting-exe-drop-malware" data-title=" " data-config-metrics-group='social_shares' data-config-metrics-title='google_shares' data-config-metrics-item='google_share' onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"></a>
      </div>
    </div>
        <div class = "share_mail"><a class="email emclick" href="mailto:?subject=Cisco Blog: Extracting EXE Drop Malware&body=I saw this post on Cisco Security blog and thought you might like to read it.%0A%0AExtracting EXE Drop Malware%0A%0Ahttps://blogs.cisco.com/security/extracting-exe-drop-malware%0A%0A****Disclaimer****%0A%0ACisco is not responsible for the content of this email, and its contents do not necessarily reflect Cisco’s views or opinions. Cisco has not verified the email address or name of the sender." data-config-metrics-group='social_shares' data-config-metrics-title='email_shares' data-config-metrics-item='email_share'></a></div>
    <div class = "clear"></div>
  </div>
  